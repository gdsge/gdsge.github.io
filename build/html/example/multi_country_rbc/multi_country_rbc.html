<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A Multi-country Business Cycle Model &mdash; GDSGE Homepage</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound" href="../ZLB/zlb.html" />
    <link rel="prev" title="Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages" href="../pandemic/GLSW2020.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GDSGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures.html">Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbc.html">Getting Started - A Simple RBC Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple_zlb/simple_zlb.html">Comparison with OccBin: A Simple Model with an Occasionally Binding Interest Rate ZLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbcIrr.html">An RBC Model with Irreversible Investment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HL1996/HL1996.html">Heaton and Lucas (1996): Incomplete Markets with Portfolio Choices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Guvenen2009/Guvenen2009.html">Guvenen (2009): Asset Pricing with Heterogeneous IES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bianchi2011/Bianchi2011.html">Bianchi (2011): Sudden Stops in Open Economies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../safe_assets/safe_assets.html">Barro et al. (2017): Safe Assets with Rare Disasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandemic/GLSW2020.html">Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">A Multi-country Business Cycle Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-model">The Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#equilibrium-conditions">Equilibrium Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solutions">Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-s-next">What’s next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ZLB/zlb.html">A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/functions.html">Toolbox API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AdditionalExamples.html">Additional Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ContributedExamples.html">Contributed Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDSGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>A Multi-country Business Cycle Model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="a-multi-country-business-cycle-model">
<h1>A Multi-country Business Cycle Model<a class="headerlink" href="#a-multi-country-business-cycle-model" title="Permalink to this heading"></a></h1>
<section id="the-model">
<h2>The Model<a class="headerlink" href="#the-model" title="Permalink to this heading"></a></h2>
<p>In this example we demonstrate the toolbox’s ability to handle models with high dimensional states, thanks to the sparse-grid interpolation method.
The model is a complete-markets multi-country business cycle model. We show that the model with 15 countries and 30 continuous states can be solved in 10 minutes with decent accuracy on a regular desktop.</p>
<p>There are <span class="math notranslate nohighlight">\(N\)</span> countries, indexed by <span class="math notranslate nohighlight">\(j\)</span>. Each country has one unit of consumers that supply labor exogenously. The consumers’ preference reads</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}_0 \sum_{t=0}^{\infty}\beta^t u(c_{j,t}).\]</div>
<p>Production in a country <span class="math notranslate nohighlight">\(j\)</span> takes capital and labor according to a Cobb-Douglas production function:</p>
<div class="math notranslate nohighlight">
\[Y_{j,t}=\exp(z_{j,t})K_{j,t}^{\alpha},\]</div>
<p>where <span class="math notranslate nohighlight">\(K_{j,t}\)</span> is capital and <span class="math notranslate nohighlight">\(z_{j,t}\)</span> is the log of country-j’s productivity that follows an AR(1) process, which is independently distributed across countries.
Capital and labor are immobile.  Capital depreciates at rate <span class="math notranslate nohighlight">\(\delta\)</span> and  investment follows a standard technology:</p>
<div class="math notranslate nohighlight">
\[K_{j,t+1} =(1-\delta)K_{j,t} + i_{j,t}.\]</div>
<p>The market is complete in that consumers can trade a full menu of Arrow securities.</p>
</section>
<section id="equilibrium-conditions">
<h2>Equilibrium Conditions<a class="headerlink" href="#equilibrium-conditions" title="Permalink to this heading"></a></h2>
<p>The complete-markets equilibrium can be characterized by the social planner’s solution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\max_{c_{j,t},i_{j,t},K_{j,t+1}} \mathbb{E}_0 \sum_j \omega_j  \sum_{t=0}^{\infty} \beta^t u(c_{j,t}),
\\
s.t. \quad \sum_j (c_{j,t}+i_{j,t})=\sum_j \exp(z_{j,t})K_{j,t}^{\alpha},
\\
K_{j,t+1} =(1-\delta)K_{j,t} + i_{j,t},
\\
\Rightarrow s.t.  \quad \sum_j (c_{j,t}+K_{j,t+1})=\sum_j \exp(z_{j,t})K_{j,t}^{\alpha}+(1-\delta)K_{j,t},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_j\)</span> is the Pareto weight assigned to consumers in country <span class="math notranslate nohighlight">\(j\)</span> that depends on the initial distribution of Arrow securities.  The first order conditions read</p>
<div class="math notranslate nohighlight">
\[\begin{split}\omega_j  u'(c_{j,t})=\lambda_t,
\\
-\lambda_t +\beta E_t \lambda_{t+1}[MPK_{j,t+1} + (1-\delta)]=0,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(MPK_{j,t}\equiv \alpha \exp(z_{j,t})K_{j,t}^{\alpha-1}\)</span>, and <span class="math notranslate nohighlight">\(\lambda_t\)</span> is the Lagrangian multiplier associated with the world resource constraint.
Therefore, the equilibrium conditions can be  stated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\lambda_t + \beta \mathbb{E}_t \lambda_{t+1}[MPK_{j,t+1} + (1-\delta)]=0, \forall j
\\
\sum_j (c_{j,t}+K_{j,t+1})=\sum_j \exp(z_{j,t})K_{j,t}^{\alpha}+(1-\delta)K_{j,t},\end{split}\]</div>
<p>for equilibrium objects <span class="math notranslate nohighlight">\((\lambda_t,K_{j,t+1})\)</span>, where</p>
<div class="math notranslate nohighlight">
\[c_{j,t}=u'^{-1}(\frac{\lambda_t}{\omega_j}).\]</div>
</section>
<section id="solutions">
<h2>Solutions<a class="headerlink" href="#solutions" title="Permalink to this heading"></a></h2>
<p>We solve the recursive equilibrium defined over the state vector <span class="math notranslate nohighlight">\((z_1,K_1,z_2,K_2,...,z_N,K_N)\)</span> of length <span class="math notranslate nohighlight">\(2\times N\)</span>. The model does not admit an analytical solution despite being simple. The numerical solution is challenging as the dimension of state space is high, and interpolation methods based on dense grids face the curse of dimensionality. In particular, the number of collocation points increases exponentially in the dimension if dense-grid methods are used. Instead, we use the adaptive-grid method that is shipped with the toolbox, with which the number of collocation points only increases in the dimension in a polynomial speed.</p>
<p>The gmod code is listed below where one can find the detailed parameterization (<a class="reference download internal" download="" href="../../_downloads/a7369edfb16717806c0213067acd17fc/rbc.gmod"><code class="xref download docutils literal notranslate"><span class="pre">rbc</span></code></a>).</p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c">% Number of countries</span>
<span class="linenos">  2</span>#define N 15
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="c">% Use asg</span>
<span class="linenos">  5</span>USE_SPLINE = 0; USE_ASG = 1;
<span class="linenos">  6</span>AsgMinLevel = 2;
<span class="linenos">  7</span>AsgMaxLevel = 2;
<span class="linenos">  8</span>AsgThreshold = 1e-2;
<span class="linenos">  9</span>AsgOutputMaxLevel = 4;
<span class="linenos"> 10</span>AsgOutputThreshold = 1e-2;
<span class="linenos"> 11</span>PrintFreq = 1;
<span class="linenos"> 12</span>SaveFreq = inf;
<span class="linenos"> 13</span>TolEq = 1e-5;
<span class="linenos"> 14</span>SIMU_RESOLVE = 0; SIMU_INTERP = 1;
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="c">% Parameters</span>
<span class="linenos"> 17</span><span class="k">parameters</span> beta sigma alpha delta numCountries;
<span class="linenos"> 18</span>beta  = 0.99;		<span class="c">% discount factor</span>
<span class="linenos"> 19</span>sigma = 2.0;		<span class="c">% CRRA coefficient</span>
<span class="linenos"> 20</span>alpha = 0.36;		<span class="c">% capital share</span>
<span class="linenos"> 21</span>delta = 0.025;		<span class="c">% depreciation rate</span>
<span class="linenos"> 22</span>numCountries = N;
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="c">% Innovations</span>
<span class="linenos"> 25</span><span class="k">parameters</span> rho_z sigma_z prob_z;
<span class="linenos"> 26</span>rho_z = 0.9;        <span class="c">% First-order autocorrelation coefficient</span>
<span class="linenos"> 27</span>sigma_z = 0.01;     <span class="c">% std of innovation of productivity</span>
<span class="linenos"> 28</span>prob_z = 1/(2*N);   <span class="c">% Probability for each perturbation; used for integration</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="c">% Pareto weights</span>
<span class="linenos"> 31</span><span class="k">parameters</span> omega_vec;
<span class="linenos"> 32</span>omega_vec = ones(1,N);
<span class="linenos"> 33</span>  
<span class="linenos"> 34</span><span class="c">% Endogenous States</span>
<span class="linenos"> 35</span>Kss  = (alpha/(1/beta - 1 + delta))^(1/(1-alpha));
<span class="linenos"> 36</span>KPts = 2;   <span class="c">% placeholder</span>
<span class="linenos"> 37</span>KMin = Kss*0.9;
<span class="linenos"> 38</span>KMax = Kss*1.1;
<span class="linenos"> 39</span>zMin = -0.05;
<span class="linenos"> 40</span>zMax = 0.05;
<span class="linenos"> 41</span>zPts = 2;   <span class="c">% placeholder</span>
<span class="linenos"> 42</span>#for i=1:N
<span class="linenos"> 43</span><span class="k">var_state</span> z#i;
<span class="linenos"> 44</span>z#i = linspace(zMin,zMax,zPts); <span class="c">% placeholder</span>
<span class="linenos"> 45</span>#end
<span class="linenos"> 46</span>#for i=1:N
<span class="linenos"> 47</span><span class="k">var_state</span> K#i;
<span class="linenos"> 48</span>K#i = linspace(KMin,KMax,KPts); <span class="c">% placeholder</span>
<span class="linenos"> 49</span>#end
<span class="linenos"> 50</span>
<span class="linenos"> 51</span><span class="k">var_policy</span>_init lambda;
<span class="linenos"> 52</span><span class="k">inbound</span>_init lambda 0 1;
<span class="linenos"> 53</span><span class="k">model_init;</span>
<span class="linenos"> 54</span>  <span class="c">% Construct vector from state</span>
<span class="linenos"> 55</span>  vector z_vec[N];
<span class="linenos"> 56</span>  vector K_vec[N];
<span class="linenos"> 57</span>  #for i=1:N
<span class="linenos"> 58</span>    z_vec(#i) = z#i;
<span class="linenos"> 59</span>    K_vec(#i) = K#i;
<span class="linenos"> 60</span>  #end
<span class="linenos"> 61</span>
<span class="linenos"> 62</span>  <span class="c">% Back out consumption from the marginal utility</span>
<span class="linenos"> 63</span>  vector c_vec[N];
<span class="linenos"> 64</span>  for i=1:N
<span class="linenos"> 65</span>    c_vec(i) = (lambda / omega_vec(i))^(-1/sigma);
<span class="linenos"> 66</span>  end
<span class="linenos"> 67</span>  
<span class="linenos"> 68</span>  <span class="c">% Calcualte resource residual</span>
<span class="linenos"> 69</span>  resource_resid = 0;
<span class="linenos"> 70</span>  for i=1:N
<span class="linenos"> 71</span>    resource_resid = resource_resid + exp(z_vec(i))*K_vec(i)^alpha + (1-delta)*K_vec(i) - c_vec(i) - K_vec(i);
<span class="linenos"> 72</span>  end
<span class="linenos"> 73</span>  <span class="k">equations;</span>
<span class="linenos"> 74</span>    resource_resid;
<span class="linenos"> 75</span>  <span class="k">end;</span>
<span class="linenos"> 76</span><span class="k">end;</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="c">% Interp</span>
<span class="linenos"> 79</span><span class="k">var_interp</span> lambda_interp;
<span class="linenos"> 80</span><span class="k">initial</span> lambda_interp lambda;
<span class="linenos"> 81</span>lambda_interp = lambda;
<span class="linenos"> 82</span>
<span class="linenos"> 83</span><span class="c">% Endogenous variables as unknowns of equations</span>
<span class="linenos"> 84</span><span class="k">var_policy</span> K_next[N]
<span class="linenos"> 85</span><span class="k">inbound</span> K_next 25 45;
<span class="linenos"> 86</span><span class="k">var_policy</span> lambda;
<span class="linenos"> 87</span><span class="k">inbound</span> lambda 0 1;
<span class="linenos"> 88</span>
<span class="linenos"> 89</span><span class="k">model;</span>
<span class="linenos"> 90</span>  <span class="c">% Construct vector from state</span>
<span class="linenos"> 91</span>  vector z_vec[N];
<span class="linenos"> 92</span>  vector K_vec[N];
<span class="linenos"> 93</span>  #for i=1:N
<span class="linenos"> 94</span>    z_vec(#i) = z#i;
<span class="linenos"> 95</span>    K_vec(#i) = K#i;
<span class="linenos"> 96</span>  #end
<span class="linenos"> 97</span>  
<span class="linenos"> 98</span>  <span class="c">% Prepare future states, under no perturbation</span>
<span class="linenos"> 99</span>  vector state_next[2*N];
<span class="linenos">100</span>  for i=1:N
<span class="linenos">101</span>    <span class="c">% First N states is future productivity</span>
<span class="linenos">102</span>    state_next(i) = rho_z*z_vec(i);
<span class="linenos">103</span>    <span class="c">% Next N states if future capital</span>
<span class="linenos">104</span>    state_next(N+i) = K_next(i);
<span class="linenos">105</span>  end
<span class="linenos">106</span>  
<span class="linenos">107</span>  <span class="c">% Calculate marginal product of capital with no perturbation</span>
<span class="linenos">108</span>  vector mpk_next[N];
<span class="linenos">109</span>  for i=1:N
<span class="linenos">110</span>    mpk_next(i) = alpha*exp(state_next(i)) * K_next(i)^(alpha-1);
<span class="linenos">111</span>  end
<span class="linenos">112</span>  
<span class="linenos">113</span>  <span class="c">% Do a sparse quadrature by perturbing productivity once at a time</span>
<span class="linenos">114</span>  vector euler_residual[N];
<span class="linenos">115</span>  for i=1:N
<span class="linenos">116</span>    euler_residual(i) = 0;
<span class="linenos">117</span>  end
<span class="linenos">118</span>  for i=1:N
<span class="linenos">119</span>    <span class="c">% Modifty future productivity of the perturbed country</span>
<span class="linenos">120</span>    <span class="c">% Positive innovation</span>
<span class="linenos">121</span>    state_next(i) = rho_z*z_vec(i) + sigma_z*sqrt(numCountries);
<span class="linenos">122</span>    mpk_next(i) = alpha*exp(state_next(i)) * K_next(i)^(alpha-1);
<span class="linenos">123</span>    lambda_future = GDSGE_INTERP_ARRAY_adouble(shock,state_next_GDSGE_GRID);
<span class="linenos">124</span>    #for j=1:N
<span class="linenos">125</span>        euler_residual(#j) = euler_residual(#j) + prob_z*(-lambda + beta*lambda_future*(mpk_next(#j)+(1-delta)));
<span class="linenos">126</span>    #end
<span class="linenos">127</span>    
<span class="linenos">128</span>    <span class="c">% Negative innovation</span>
<span class="linenos">129</span>    state_next(i) = rho_z*z_vec(i) - sigma_z*sqrt(numCountries);
<span class="linenos">130</span>    mpk_next(i) = alpha*exp(state_next(i)) * K_next(i)^(alpha-1);
<span class="linenos">131</span>    lambda_future = GDSGE_INTERP_ARRAY_adouble(shock,state_next_GDSGE_GRID);
<span class="linenos">132</span>    #for j=1:N
<span class="linenos">133</span>        euler_residual(#j) = euler_residual(#j) + prob_z*(-lambda + beta*lambda_future*(mpk_next(#j)+(1-delta)));
<span class="linenos">134</span>    #end
<span class="linenos">135</span>    
<span class="linenos">136</span>    <span class="c">% Revert the perturbation back</span>
<span class="linenos">137</span>    state_next(i) = rho_z*z_vec(i);
<span class="linenos">138</span>    mpk_next(i) = alpha*exp(state_next(i)) * K_next(i)^(alpha-1);
<span class="linenos">139</span>  end
<span class="linenos">140</span>
<span class="linenos">141</span>  <span class="c">% Back out consumption from the marginal utility</span>
<span class="linenos">142</span>  vector c_vec[N];
<span class="linenos">143</span>  for i=1:N
<span class="linenos">144</span>    c_vec(i) = (lambda / omega_vec(i))^(-1/sigma);
<span class="linenos">145</span>  end
<span class="linenos">146</span>  <span class="c">% Calcualte resource residual</span>
<span class="linenos">147</span>  resource_resid = 0;
<span class="linenos">148</span>  for i=1:N
<span class="linenos">149</span>    resource_resid = resource_resid + exp(z_vec(i))*K_vec(i)^alpha + (1-delta)*K_vec(i) - c_vec(i) - K_next(i);
<span class="linenos">150</span>  end
<span class="linenos">151</span>  
<span class="linenos">152</span>  <span class="c">% Record variables</span>
<span class="linenos">153</span>  #for i=1:N
<span class="linenos">154</span>    K_next_output#i = K_next(#i);
<span class="linenos">155</span>    c#i = c_vec(#i);
<span class="linenos">156</span>  #end
<span class="linenos">157</span>  
<span class="linenos">158</span>  <span class="k">equations;</span>
<span class="linenos">159</span>    for i=1:N
<span class="linenos">160</span>        euler_residual(i);
<span class="linenos">161</span>    end
<span class="linenos">162</span>    resource_resid;
<span class="linenos">163</span>  <span class="k">end;</span>
<span class="linenos">164</span><span class="k">end;</span>
<span class="linenos">165</span>
<span class="linenos">166</span><span class="k">simulate;</span>
<span class="linenos">167</span>  <span class="k">num_samples</span> = 24;
<span class="linenos">168</span>  <span class="k">num_periods</span> = 1000;
<span class="linenos">169</span>  #for i=1:N
<span class="linenos">170</span>    <span class="k">initial</span> shock 1;
<span class="linenos">171</span>    <span class="k">initial</span> z#i 0;
<span class="linenos">172</span>    <span class="k">initial</span> K#i Kss;
<span class="linenos">173</span>    <span class="k">var_simu</span> K_next_output#i c#i;
<span class="linenos">174</span>    z#i&#39; = z_exo(:,GNDSGE_t+1,#i);
<span class="linenos">175</span>    K#i&#39; = K_next_output#i;
<span class="linenos">176</span>  #end
<span class="linenos">177</span><span class="k">end;</span>
</pre></div>
</div>
<p>The code utilizes the macro feature of the toolbox. For example, the code block</p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="linenos">42</span>#for i=1:N
<span class="linenos">43</span><span class="k">var_state</span> z#i;
<span class="linenos">44</span>z#i = linspace(zMin,zMax,zPts); <span class="c">% placeholder</span>
<span class="linenos">45</span>#end
</pre></div>
</div>
<p>expands to</p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="k">var_state</span> z1;
z1 = linspace(zMin,zMax,zPts); <span class="c">% placeholder</span>

<span class="k">var_state</span> z2;
z2 = linspace(zMin,zMax,zPts); <span class="c">% placeholder</span>

...

<span class="k">var_state</span> z15;
z15 = linspace(zMin,zMax,zPts); <span class="c">% placeholder</span>
</pre></div>
</div>
<p>The strategy we use for integrating over future shocks follows the monomial integration proposed by <a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.3982/QE14">Judd, Maliar and Maliar (2011, QE)</a>,
which calculates the integration by perturbing future innovation from zero along one dimension at a time. This is implemented by Line 118-139 of the code.</p>
<p>The policy functions can be solved by simply calling <em>iterRslt = iter_rbc.m</em> after the gmod is compiled. The policy iteration takes around 10 minutes on a regular desktop (with a 12-core 2.5GHz CPU).</p>
<p>Simulation, however, requires some manual configuration as now we need to feed in shocks generated from the actual AR(1) processes, instead of the realizations of shocks used for integration in solving the policy functions. Please refer to <a class="reference download internal" download="" href="../../_downloads/76058ab5ced22676818df976be45361b/main_simulate.m"><code class="xref download docutils literal notranslate"><span class="pre">main_simulate</span></code></a> for how to generate a Markov process using MATLAB’s built-in functions, and feed in the simulated processes into
the toolbox-generated code.</p>
<p>The file also contains procedures in calculating the Euler equation errors. The unit-free Euler equation error is defined as</p>
<div class="math notranslate nohighlight">
\[\mathcal{E}_{j,t}=\Big|-1+\frac{ \beta \mathbb{E}_t u'(c_{j,t+1})[MPK_{j,t+1} + (1-\delta)]}{u'(c_{j,t})}\Big|.\]</div>
<p>The error given one state can be calculated by simulating a large sample one period forward starting from this state, and integrating over these sample paths. The script file implements this procedure and reports the max and mean errors for a sample of states drawn from the ergodic distribution (running the calculation requires 16GB memory; set the number of paths lower to reduce the memory requirement). The max error is 6.4E-4 and the mean error is 5.7E-4 across states in the ergodic set, demonstrating that the solutions are obtained with decent accuracy, despite the very sparse grid used for interpolation.</p>
</section>
<section id="what-s-next">
<h2>What’s next<a class="headerlink" href="#what-s-next" title="Permalink to this heading"></a></h2>
<p>The current example demonstrates that the toolbox can handle models with high dimensional states, with dimension up to 30 on a regular desktop/laptop. However, we note that providing an accurate global solution to a highly-nonlinear albeit low-dimensional model is often much harder than providing a solution to a high-dimensional but less nonlinear model. Nevertheless, this means that one can solve standard medium New-Keynesian models with the toolbox (e.g., the benchmark model in Smets and Wouters (2007) has 9 exogenous and 11 endogenous state variables), and extend these models with nonlinear features such as an occasionally binding interest rate zero lower bound as in <a class="reference internal" href="../ZLB/zlb.html#zlb"><span class="std std-ref">the ZLB example</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../pandemic/GLSW2020.html" class="btn btn-neutral float-left" title="Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ZLB/zlb.html" class="btn btn-neutral float-right" title="A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Dan Cao, Wenlan Luo, and Guangyu Nie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>