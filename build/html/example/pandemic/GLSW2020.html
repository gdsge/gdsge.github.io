<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages &mdash; GDSGE Homepage</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A Multi-country Business Cycle Model" href="../multi_country_rbc/multi_country_rbc.html" />
    <link rel="prev" title="Barro et al. (2017): Safe Assets with Rare Disasters" href="../safe_assets/safe_assets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GDSGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures.html">Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbc.html">Getting Started - A Simple RBC Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple_zlb/simple_zlb.html">Comparison with OccBin: A Simple Model with an Occasionally Binding Interest Rate ZLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbcIrr.html">An RBC Model with Irreversible Investment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HL1996/HL1996.html">Heaton and Lucas (1996): Incomplete Markets with Portfolio Choices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Guvenen2009/Guvenen2009.html">Guvenen (2009): Asset Pricing with Heterogeneous IES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bianchi2011/Bianchi2011.html">Bianchi (2011): Sudden Stops in Open Economies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../safe_assets/safe_assets.html">Barro et al. (2017): Safe Assets with Rare Disasters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-model">The Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calibration">Calibration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-gmod-file-and-results">The gmod File and Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../multi_country_rbc/multi_country_rbc.html">A Multi-country Business Cycle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZLB/zlb.html">A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/functions.html">Toolbox API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AdditionalExamples.html">Additional Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ContributedExamples.html">Contributed Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDSGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="guerrieri-et-al-2020-negative-supply-shocks-that-cause-demand-shortages">
<h1>Guerrieri et al. (2020): Negative Supply Shocks That Cause Demand Shortages<a class="headerlink" href="#guerrieri-et-al-2020-negative-supply-shocks-that-cause-demand-shortages" title="Permalink to this heading"></a></h1>
<section id="the-model">
<h2>The Model<a class="headerlink" href="#the-model" title="Permalink to this heading"></a></h2>
<p>In this timely and important contribution, <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri, Lorenzoni, Straub, and Werning (2020)</a>  analyze the effects of supply shocks such as shutdowns, layoffs, and firm exits due to COVID-19. They show that in a two-sector model, these supply shocks can trigger changes in aggregate demand larger than the shocks themselves. This is the case when the elasticity of substitution across sectors is not too large and the inter-temporal elasticity of substitution is sufficiently high.</p>
<p>Their model is deterministic and the supply shock is unexpected. They also assume maximally tight borrowing constraint. We extend their model to allow for stochastic, recurrent shocks and more relaxed borrowing constraint. This extension can be solved easily using our toolbox.</p>
<p>We follow closely the notation in <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a>. The total population is normalized to one, with a fraction
<span class="math notranslate nohighlight">\(\phi\)</span> of agents working in sector 1 and the remaining fraction <span class="math notranslate nohighlight">\(1-\phi\)</span>
of agents working in section 2. We assume that workers are perfectly
specialized in their sector. Sector 1 is the contact-intensive sector that is directly affected by the supply shock.</p>
<p>The labor endowment of workers in sector 2 is constant and is set to <span class="math notranslate nohighlight">\(\bar{n}\)</span>, while the labor endowment
of workers in sector 1 follows a two-point Markov process with state in <span class="math notranslate nohighlight">\(\{1,2\}\)</span>, where <span class="math notranslate nohighlight">\(1\)</span> corresponds to normal times and <span class="math notranslate nohighlight">\(2\)</span> corresponds to pandemics. During normal times, their labor endowment is <span class="math notranslate nohighlight">\(n_1=\bar{n}\)</span>,
while when a supply shock hits, their labor endowment drops to <span class="math notranslate nohighlight">\(n_1=\delta\bar{n}\)</span>
with <span class="math notranslate nohighlight">\(\delta&lt;1\)</span>. In the COVID-19 example, as sector 1 is contact-intensive and a fraction <span class="math notranslate nohighlight">\(\delta\)</span> of its
production is shut down when the pandemic hits. On the other hand, sector 2 is unaffected.
The transition matrix between these two states is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{cc}
\pi_{1} &amp; 1-\pi_{1}\\
1-\pi_{2} &amp; \pi_{2}
\end{array}\right],\end{split}\]</div>
<p>in which <span class="math notranslate nohighlight">\(1-\pi_{1}\)</span> is a small probability for the economy to enter
the supply-driven crisis, and <span class="math notranslate nohighlight">\(\pi_{2}\)</span> is the probability for the
crisis to last for one more period.</p>
<p>The production technology is linear in both sectors:</p>
<div class="math notranslate nohighlight">
\[Y_{jt}=N_{jt}\]</div>
<p>for <span class="math notranslate nohighlight">\(j=1,2\)</span>. Competitive firms in each sector <span class="math notranslate nohighlight">\(j\)</span> hire workers at
wage <span class="math notranslate nohighlight">\(W_{jt}\)</span> and sell their products at price <span class="math notranslate nohighlight">\(P_{jt}\)</span>. Prices
are flexible, and given the market structure we have <span class="math notranslate nohighlight">\(P_{jt}=W_{jt}\)</span>.
The consumer’s utility function is</p>
<div class="math notranslate nohighlight" id="equation-utility-glsw">
<span class="eqno">(11)<a class="headerlink" href="#equation-utility-glsw" title="Permalink to this equation"></a></span>\[\mathbb{E}_{0}\left[\sum_{t=0}^{\infty}\beta^{t}\frac{C_{t}^{1-\sigma}}{1-\sigma}\right],\]</div>
<p>in which</p>
<div class="math notranslate nohighlight">
\[C_{t}=\left(\phi^{\rho}c_{1t}^{1-\rho}+\left(1-\phi\right)^{\rho}c_{2t}^{1-\rho}\right)^{\frac{1}{1-\rho}},\]</div>
<p>which features constant elasticity of subsitution <span class="math notranslate nohighlight">\(1/\rho\)</span> between the two goods
and constant intertemporal elasticity of substitution <span class="math notranslate nohighlight">\(1/\sigma\)</span>.</p>
<p>As in <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a>, here
we set good 2 to be the numeraire, i.e., <span class="math notranslate nohighlight">\(P_{2t}\equiv1\)</span>. Workers in sector <span class="math notranslate nohighlight">\(j\)</span> maximize <a class="reference internal" href="#equation-utility-glsw">(11)</a> subject to</p>
<div class="math notranslate nohighlight" id="equation-budget-glsw">
<span class="eqno">(12)<a class="headerlink" href="#equation-budget-glsw" title="Permalink to this equation"></a></span>\[P_{1t}c_{1t}^{j}+c_{2t}^{j}+\frac{a_{t+1}^{j}}{1+r_{t}}\leq W_{jt}n_{t}^{j}+a_{t}^{j},\]</div>
<p>where they allocate their labor income and bond holding
from the previous period, <span class="math notranslate nohighlight">\(a_{t}^{j}\)</span> among consumption goods produced
in the two sectors and bond holding into the next period. Interest
rate <span class="math notranslate nohighlight">\(r_{t}\)</span> is determined competitively.</p>
<p>In addition, we assume that the workers are subject to the
following borrowing constraint:</p>
<div class="math notranslate nohighlight" id="equation-borrowing-constraint-glsw">
<span class="eqno">(13)<a class="headerlink" href="#equation-borrowing-constraint-glsw" title="Permalink to this equation"></a></span>\[a_{t+1}^{j}\geq-\bar{A}.\]</div>
<p>Denote sector <span class="math notranslate nohighlight">\(j\)</span> workers’ Lagrangian multiplier for the
budget constraint <a class="reference internal" href="#equation-budget-glsw">(12)</a> as <span class="math notranslate nohighlight">\(\beta^{t}\lambda_{t}^{j}\)</span>,
and the multiplier for the borrowing constraint as <span class="math notranslate nohighlight">\(\beta^{t}\mu_{t}^{j}\)</span>.
The first-order conditions for the workers’ optimal decision are:</p>
<div class="math notranslate nohighlight">
\[\lambda_{t}^{j}=\left(C_{t}^{j}\right)^{\rho-\sigma}\left(1-\phi\right)^{\rho}\left(c_{2t}^{j}\right)^{-\rho},\]</div>
<div class="math notranslate nohighlight" id="equation-price-glsw">
<span class="eqno">(14)<a class="headerlink" href="#equation-price-glsw" title="Permalink to this equation"></a></span>\[P_{1t}=\left(\frac{c_{1t}^{j}/\phi}{c_{2t}^{j}/\left(1-\phi\right)}\right)^{-\rho},\]</div>
<div class="math notranslate nohighlight" id="equation-foc-glsw">
<span class="eqno">(15)<a class="headerlink" href="#equation-foc-glsw" title="Permalink to this equation"></a></span>\[-\frac{\lambda_{t}^{j}}{1+r_{t}}+\mu_{t}^{j}+\beta\mathbb{E}_{t}\left(\lambda_{t+1}^{j}\right)=0,\]</div>
<div class="math notranslate nohighlight" id="equation-slackness-glsw">
<span class="eqno">(16)<a class="headerlink" href="#equation-slackness-glsw" title="Permalink to this equation"></a></span>\[\mu_{t}^{j}\left(a_{t+1}^{j}+\bar{A}\right)=0.\]</div>
<p>And we also have the market clearing conditions for bond
and consumption good 2:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp; \phi a_{t+1}^{1}+\left(1-\phi\right)a_{t+1}^{2}=0,\\
&amp; \phi c_{2t}^{1}+\left(1-\phi\right)c_{2t}^{2}=\left(1-\phi\right)\bar{n},\end{split}\]</div>
<p>and the market clearing conditions of consumption good 1 is implied
by Walras’ law.</p>
<p>We use <span class="math notranslate nohighlight">\(a^1_t\)</span> as the endogenous state variable and look for a recursive equilibrium as a mapping from <span class="math notranslate nohighlight">\(\left(z_t,a^1_t\right)\)</span> to the allocation and prices that satisfies the first-order conditions and market clearing conditions above.</p>
<p>Notice that by the pricing equation <a class="reference internal" href="#equation-price-glsw">(14)</a>,</p>
<div class="math notranslate nohighlight">
\[\frac{c_{1t}^{1}}{c_{1t}^{2}}=\frac{c_{2t}^{1}}{c_{2t}^{2}},\]</div>
<p>which means the consumption shares of workers in sector 1 are the
same between these two consumption goods. Denote the consumption share
of workers in sector 1 as <span class="math notranslate nohighlight">\(\tilde{c}_{1t}\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}c_{1t}^{1} &amp; =\tilde{c}_{1t}n_{1t},\\
c_{1t}^{2} &amp; =\left(1-\tilde{c}_{1t}\right)\phi n_{1t}/\left(1-\phi\right),\\
c_{2t}^{1} &amp; =\tilde{c}_{1t}\left(1-\phi\right)\bar{n}/\phi,\\
c_{2t}^{2} &amp; =\left(1-\tilde{c}_{1t}\right)\bar{n},\end{split}\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_{t}^{1} &amp; =\frac{\tilde{c}_{1t}}{\phi}Y_{t},\\
C_{t}^{2} &amp; =\frac{1-\tilde{c}_{1t}}{1-\phi}Y_{t},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(Y_{t}=\left[\phi n_{1t}^{1-\rho}+\left(1-\phi\right)\bar{n}^{1-\rho}\right]^{\frac{1}{1-\rho}}\)</span>,
and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lambda_{t}^{1} &amp; =\left(\frac{\tilde{c}_{1t}}{\phi}Y_{t}\right)^{-\sigma}\left(\frac{Y_{t}}{\bar{n}}\right)^{\rho},\\
\lambda_{t}^{2} &amp; =\left(\frac{1-\tilde{c}_{1t}}{1-\phi}Y_{t}\right)^{-\sigma}\left(\frac{Y_{t}}{\bar{n}}\right)^{\rho}.\end{split}\]</div>
<p>In total, for each <span class="math notranslate nohighlight">\(z_t\)</span> and <span class="math notranslate nohighlight">\(a^1_t\)</span>, the minimal equilibrium system can be represented by  5 unknowns: <span class="math notranslate nohighlight">\(\left\{ \tilde{c}_{1t},a_{t+1}^{1},\mu_{t}^{1},\mu_{t}^{2},r_{t+1}\right\}\)</span>,
and can be solved by a system of  5 equations: the budget
of workers in sector 1, equation <a class="reference internal" href="#equation-budget-glsw">(12)</a>, and the FOC in equation <a class="reference internal" href="#equation-foc-glsw">(15)</a>,
and slackness condition in equation <a class="reference internal" href="#equation-slackness-glsw">(16)</a> for
<span class="math notranslate nohighlight">\(j=1,2\)</span>.</p>
<section id="calibration">
<h3>Calibration<a class="headerlink" href="#calibration" title="Permalink to this heading"></a></h3>
<p>We use quarters for model periods and standard parameters in the literature. For preferences, we use <span class="math notranslate nohighlight">\(\beta = 0.99\)</span> as the quarterly discount factor. The inverse inter-temporal elasticity of substitution is set at <span class="math notranslate nohighlight">\(\sigma = 0.5\)</span> (strictly less than <span class="math notranslate nohighlight">\(1\)</span> as required by the analytical results  <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a> for supply shocks to trigger larger aggregate demand responses). We vary the inverse intra-temporal elasticity of substitution <span class="math notranslate nohighlight">\(\rho\)</span> between <span class="math notranslate nohighlight">\(0.1\)</span> and <span class="math notranslate nohighlight">\(0.9\)</span>.</p>
<p>For labor market parameters, we normalize <span class="math notranslate nohighlight">\(\bar{n}\)</span> at <span class="math notranslate nohighlight">\(1\)</span>. The share of the contact-intensive sector <span class="math notranslate nohighlight">\(\phi\)</span> is set at <span class="math notranslate nohighlight">\(0.2\)</span>. We assume that when the pandemic shocks hit, labor supply in the contact-intensive sector declines by <span class="math notranslate nohighlight">\(50\%\)</span> (roughly consistent with the increase in unemployment claims in the U.S. during the pandemics). We assume that the pandemics last for 2 quarters on average, so <span class="math notranslate nohighlight">\(\pi_2 = 0.5\)</span> and <span class="math notranslate nohighlight">\(\pi_1\)</span> is chosen so that the economy stays in pandemics in around <span class="math notranslate nohighlight">\(0.5\%\)</span> of the times (consistent with historical frequency). Borrowing limit <span class="math notranslate nohighlight">\(\bar{A}\)</span> is set at <span class="math notranslate nohighlight">\(30\%\)</span> of the wage in normal times.
For the benchmark results, we use <span class="math notranslate nohighlight">\(\rho = 0.75&gt;\sigma = 0.5\)</span>.</p>
</section>
</section>
<section id="the-gmod-file-and-results">
<h2>The gmod File and Results<a class="headerlink" href="#the-gmod-file-and-results" title="Permalink to this heading"></a></h2>
<p>The model can be solved with the following gmod file (<a class="reference download internal" download="" href="../../_downloads/d8c65c9ad1071d2ac99ac97fc3427f5b/GLSW.gmod"><code class="xref download docutils literal notranslate"><span class="pre">GLSW</span></code></a>).</p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c">% Created: April-9-2020</span>
<span class="linenos">  2</span><span class="c">% This model generalizes the two-period model in Guerrieri et.al (2020) studying the macro effect of COVID-19 with recurrent shocks to labor supply</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="c">% Parameters</span>
<span class="linenos">  5</span><span class="k">parameters</span> beta rho sigma phi nbar delta Abar;
<span class="linenos">  6</span>beta = 0.99;    <span class="c">% discount factor</span>
<span class="linenos">  7</span>rho = 0.75;     <span class="c">% 1/rho intratemporal elasticity</span>
<span class="linenos">  8</span>sigma = 0.5;    <span class="c">% 1/sigma intertemporal elasticity</span>
<span class="linenos">  9</span>phi = 0.2;      <span class="c">% share of sector 1</span>
<span class="linenos"> 10</span>nbar = 1;       <span class="c">% normal labor endowment</span>
<span class="linenos"> 11</span>delta = 0.5;    <span class="c">% fraction of labor endowment during crisis</span>
<span class="linenos"> 12</span>Abar = 0.3;     <span class="c">% borrowing limit</span>
<span class="linenos"> 13</span>TolEq = 1e-8;   <span class="c">% Solve with high adccuracy</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="c">% Shocks</span>
<span class="linenos"> 16</span><span class="k">var_shock</span> n1;
<span class="linenos"> 17</span><span class="k">shock_num</span> = 2;
<span class="linenos"> 18</span>pi2 = 0.5;      <span class="c">% the pandemic lasts for 2 quarters</span>
<span class="linenos"> 19</span>freq = 0.005;   <span class="c">% frequency of pandemic: 0.5 percent of the time.</span>
<span class="linenos"> 20</span>pi1 = 1 - (freq/(1-freq))*(1-pi2);
<span class="linenos"> 21</span><span class="k">shock_trans</span> = [pi1,1-pi1;
<span class="linenos"> 22</span>               1-pi2,pi2];
<span class="linenos"> 23</span>n1 = [nbar,delta*nbar];
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="c">% Endogenous States</span>
<span class="linenos"> 26</span><span class="k">var_state</span> a1;
<span class="linenos"> 27</span>Ngrid = 301;
<span class="linenos"> 28</span>a1_lb = -Abar;
<span class="linenos"> 29</span>a1_ub = (1-phi)*Abar/phi;
<span class="linenos"> 30</span>a1 = linspace(a1_lb,a1_ub,Ngrid);
<span class="linenos"> 31</span>
<span class="linenos"> 32</span><span class="c">% Last period</span>
<span class="linenos"> 33</span><span class="k">var_policy</span>_init c1_shr;
<span class="linenos"> 34</span><span class="k">inbound</span>_init c1_shr 0 1;
<span class="linenos"> 35</span><span class="k">var_aux</span>_init P1 log_lambda1 log_lambda2;
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="k">model_init;</span>
<span class="linenos"> 38</span>   c1_1 = c1_shr*(phi*n1)/phi;
<span class="linenos"> 39</span>   c2_1 = (1-c1_shr)*(phi*n1)/(1-phi);
<span class="linenos"> 40</span>   c1_2 = c1_shr*((1-phi)*nbar)/phi;
<span class="linenos"> 41</span>   c2_2 = (1-c1_shr)*((1-phi)*nbar)/(1-phi);
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>   Y = (phi*n1^(1-rho) + (1-phi)*nbar^(1-rho))^(1/(1-rho));
<span class="linenos"> 44</span>   lambda1 = (c1_shr/phi*Y)^(-sigma)*(Y/nbar)^rho;
<span class="linenos"> 45</span>   lambda2 = ((1-c1_shr)/(1-phi)*Y)^(-sigma)*(Y/nbar)^rho;
<span class="linenos"> 46</span>   log_lambda1 = log(lambda1);
<span class="linenos"> 47</span>   log_lambda2 = log(lambda2);
<span class="linenos"> 48</span>   
<span class="linenos"> 49</span>   <span class="c">% price of good 1</span>
<span class="linenos"> 50</span>   P1 = ((c1_1/phi)/(c1_2/(1-phi)))^(-rho);
<span class="linenos"> 51</span>   <span class="c">% wage of sector 1</span>
<span class="linenos"> 52</span>   W1 = P1;
<span class="linenos"> 53</span>   budget1_resid = P1*c1_1 + c1_2 - W1*n1 - a1;
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>  <span class="k">equations;</span>
<span class="linenos"> 56</span>     budget1_resid;
<span class="linenos"> 57</span>  <span class="k">end;</span>
<span class="linenos"> 58</span><span class="k">end;</span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span><span class="k">var_interp</span> log_lambda1_interp log_lambda2_interp;
<span class="linenos"> 61</span><span class="k">initial</span> log_lambda1_interp log_lambda1;
<span class="linenos"> 62</span><span class="k">initial</span> log_lambda2_interp log_lambda2;
<span class="linenos"> 63</span><span class="c">% Updates</span>
<span class="linenos"> 64</span>log_lambda1_interp = log_lambda1;
<span class="linenos"> 65</span>log_lambda2_interp = log_lambda2;
<span class="linenos"> 66</span>
<span class="linenos"> 67</span>% Endogenous variables, bounds, and <span class="k">initial</span> values
<span class="linenos"> 68</span><span class="k">var_policy</span> c1_shr a1n mu1 mu2 r;
<span class="linenos"> 69</span><span class="k">inbound</span> c1_shr 0 1;
<span class="linenos"> 70</span><span class="k">inbound</span> a1n -Abar (1-phi)*Abar/phi;
<span class="linenos"> 71</span><span class="k">inbound</span> mu1 0 1;
<span class="linenos"> 72</span><span class="k">inbound</span> mu2 0 1;
<span class="linenos"> 73</span><span class="k">inbound</span> r -0.5 0.5;
<span class="linenos"> 74</span>
<span class="linenos"> 75</span><span class="c">% Other equilibrium variables</span>
<span class="linenos"> 76</span><span class="k">var_aux</span> a2 P1 log_lambda1 log_lambda2;
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="k">model;</span>
<span class="linenos"> 79</span>   a2 = -a1*phi/(1-phi);
<span class="linenos"> 80</span>   c1_1 = c1_shr*(phi*n1)/phi;
<span class="linenos"> 81</span>   c2_1 = (1-c1_shr)*(phi*n1)/(1-phi);
<span class="linenos"> 82</span>   c1_2 = c1_shr*((1-phi)*nbar)/phi;
<span class="linenos"> 83</span>   c2_2 = (1-c1_shr)*((1-phi)*nbar)/(1-phi);
<span class="linenos"> 84</span>
<span class="linenos"> 85</span>   Y = (phi*n1^(1-rho) + (1-phi)*nbar^(1-rho))^(1/(1-rho));
<span class="linenos"> 86</span>   lambda1 = (c1_shr/phi*Y)^(-sigma)*(Y/nbar)^rho;
<span class="linenos"> 87</span>   lambda2 = ((1-c1_shr)/(1-phi)*Y)^(-sigma)*(Y/nbar)^rho;
<span class="linenos"> 88</span>   log_lambda1 = log(lambda1);
<span class="linenos"> 89</span>   log_lambda2 = log(lambda2);
<span class="linenos"> 90</span>
<span class="linenos"> 91</span>   <span class="c">% price of good 1</span>
<span class="linenos"> 92</span>   P1 = ((c1_1/phi)/(c1_2/(1-phi)))^(-rho);
<span class="linenos"> 93</span>   <span class="c">% wage of sector 1</span>
<span class="linenos"> 94</span>   W1 = P1;
<span class="linenos"> 95</span>
<span class="linenos"> 96</span>   log_lambda1Future&#39; = log_lambda1_interp&#39;(a1n);
<span class="linenos"> 97</span>   log_lambda2Future&#39; = log_lambda2_interp&#39;(a1n);
<span class="linenos"> 98</span>   lambda1Future&#39; = exp(log_lambda1Future&#39;);
<span class="linenos"> 99</span>   lambda2Future&#39; = exp(log_lambda2Future&#39;);
<span class="linenos">100</span>
<span class="linenos">101</span>   budget1_resid = P1*c1_1 + c1_2 + a1n/(1+r) - W1*n1 - a1;
<span class="linenos">102</span>   euler_residual = 1 - beta*(1+r) * <span class="k">GDSGE_EXPECT</span>{lambda1Future&#39;}/lambda1 - mu1;
<span class="linenos">103</span>   euler_residua2 = 1 - beta*(1+r) * <span class="k">GDSGE_EXPECT</span>{lambda2Future&#39;}/lambda2 - mu2;
<span class="linenos">104</span> 
<span class="linenos">105</span>   a2n = -a1n*phi/(1-phi);
<span class="linenos">106</span>   slackness1 = mu1*(a1n + Abar);
<span class="linenos">107</span>   slackness2 = mu2*(a2n + Abar);
<span class="linenos">108</span>  <span class="k">equations;</span>
<span class="linenos">109</span>     budget1_resid;
<span class="linenos">110</span>     euler_residual;
<span class="linenos">111</span>     euler_residua2;
<span class="linenos">112</span>     slackness1;
<span class="linenos">113</span>     slackness2;
<span class="linenos">114</span>  <span class="k">end;</span>
<span class="linenos">115</span><span class="k">end;</span>
<span class="linenos">116</span>
<span class="linenos">117</span><span class="k">simulate;</span>
<span class="linenos">118</span>  <span class="k">num_periods</span> = 10000;
<span class="linenos">119</span>  <span class="k">num_samples</span> = 20;
<span class="linenos">120</span>  <span class="k">initial</span> a1 0;
<span class="linenos">121</span>  <span class="k">initial</span> shock 1;
<span class="linenos">122</span>  
<span class="linenos">123</span>  <span class="k">var_simu</span> a2 P1 r c1_shr;
<span class="linenos">124</span>
<span class="linenos">125</span>  a1&#39; = a1n;
<span class="linenos">126</span><span class="k">end;</span>
</pre></div>
</div>
<p>With the generated files returned by the <a class="reference external" href="http://www.gdsge.com">online compiler</a>, we can run the <em>iter_GLSW</em> procedure to solve the policy iterations,
and then pass the converged solutions to the <em>simulate_GLSW</em> procedure to simulate the ergodic set of the model.</p>
<p>We first solve the policy iterations by calling <em>iter_GLSW</em> in MATLAB, which produces</p>
<div class="highlight-MATLAB notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">IterRslt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">iter_GLSW</span><span class="p">;</span><span class="w"></span>

<span class="n">Iter</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">Metric</span><span class="p">:</span><span class="mf">0.00484804</span><span class="p">,</span><span class="w"> </span><span class="n">maxF</span><span class="p">:</span><span class="mf">8.57919e-09</span><span class="w"></span>
<span class="n">Elapsed</span><span class="w"> </span><span class="s">time</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">0.170275</span><span class="w"> </span><span class="s">seconds.</span><span class="w"></span>

<span class="k">...</span><span class="w"></span>

<span class="n">Iter</span><span class="p">:</span><span class="mi">1289</span><span class="p">,</span><span class="w"> </span><span class="n">Metric</span><span class="p">:</span><span class="mf">8.94807e-09</span><span class="p">,</span><span class="w"> </span><span class="n">maxF</span><span class="p">:</span><span class="mf">9.65947e-09</span><span class="w"></span>
<span class="n">Elapsed</span><span class="w"> </span><span class="s">time</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">0.079467</span><span class="w"> </span><span class="s">seconds.</span><span class="w"></span>
</pre></div>
</div>
<p>Then we pass the converged solutions to <em>simulate_GLSW</em>, which produces
(depending on your random seed; set rng(0823) to produce the exact results below)</p>
<div class="highlight-MATLAB notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">SimuRslt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">simulate_GLSW</span><span class="p">(</span><span class="n">IterRslt</span><span class="p">);</span><span class="w"></span>

<span class="n">Periods</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w"></span>
<span class="n">shock</span><span class="w">      </span><span class="s">a1</span><span class="w">      </span><span class="s">a2</span><span class="w">      </span><span class="s">P1</span><span class="w">       </span><span class="s">r</span><span class="w">  </span><span class="s">c1_shr</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span><span class="w">  </span><span class="mf">0.3994</span><span class="o">-</span><span class="mf">0.09985</span><span class="w">       </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.01018</span><span class="w">  </span><span class="mf">0.2006</span><span class="w"></span>
<span class="n">Elapsed</span><span class="w"> </span><span class="s">time</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">0.653297</span><span class="w"> </span><span class="s">seconds.</span><span class="w"></span>

<span class="k">...</span><span class="w"></span>

<span class="n">Periods</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="w"></span>
<span class="n">shock</span><span class="w">      </span><span class="s">a1</span><span class="w">      </span><span class="s">a2</span><span class="w">      </span><span class="s">P1</span><span class="w">       </span><span class="s">r</span><span class="w">  </span><span class="s">c1_shr</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="mf">1.18</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2951</span><span class="w">       </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.01018</span><span class="w">  </span><span class="mf">0.2023</span><span class="w"></span>
<span class="n">Elapsed</span><span class="w"> </span><span class="s">time</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">0.761543</span><span class="w"> </span><span class="s">seconds.</span><span class="w"></span>
</pre></div>
</div>
<p>Then we can inspect the policy functions for interest rate and the stationary distribution of workers 1’s bond holding</p>
<div class="highlight-MATLAB notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="nb">plot</span><span class="p">(</span><span class="n">IterRslt</span><span class="p">.</span><span class="n">var_state</span><span class="p">.</span><span class="n">a1</span><span class="p">,</span><span class="n">IterRslt</span><span class="p">.</span><span class="n">var_policy</span><span class="p">.</span><span class="n">r</span><span class="p">);</span><span class="w"></span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="nb">histogram</span><span class="p">(</span><span class="n">SimuRslt</span><span class="p">.</span><span class="n">a1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>With some cosmetic modifications we get the following figure.</p>
<a class="reference internal image-reference" href="../../_images/policy.png"><img alt="../../_images/policy.png" src="../../_images/policy.png" style="width: 504.0px; height: 378.0px;" /></a>
<p>The upper panel in the figure shows the interest rate as a function of the endogenous state variable <span class="math notranslate nohighlight">\(a^1_t\)</span> in normal times (<span class="math notranslate nohighlight">\(z=1\)</span>) and during pandemics (<span class="math notranslate nohighlight">\(z=2\)</span>).
Interest rate is lower during pandemics, which reflects that the aggregate demand response outweighs the supply shock, a result emphasized in <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a>.
In addition, the figure also shows that the effect is stronger when the net worth of workers in the contact-intensive sector is low.
The lower panel plots the ergodic distribution of bond holding of workers in the contact_intensive sector. The possibility of pandemics leads these workers to do precautionary saving, sometimes up to the borrowing limit of workers in sector 2. However, the precautionary saving does not undo the results in <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a>.</p>
<p>Starting from the model’s ergodic set, we can simulate the <em>generalized impulse response functions</em> by comparing two sets of sample paths drawn from the model’s ergodic set: one benchmark,
the other with the <em>pandemic</em> shock hitting at the first period and the transition of the exogenous shock turned on. Download the MATLAB script file that calls the toolbox codes to simulate the
<em>generalized impulse response functions</em> <a class="reference download internal" download="" href="../../_downloads/2a539f2396e57c90f5335a51720dcf4e/main_simulate_irf.m"><code class="xref download docutils literal notranslate"><span class="pre">main_simulate_irf.m</span></code></a>.</p>
<a class="reference internal image-reference" href="../../_images/irf_r_a1.png"><img alt="../../_images/irf_r_a1.png" src="../../_images/irf_r_a1.png" style="width: 525.0px; height: 393.9px;" /></a>
<p>As shown, while interest rate reverts relatively quickly to the pre-pandemic level after the shock,
workers in sector 1 suffer from a persistent, long-lasting wealth lost.</p>
<p>To further investigate the robustness of the results, the following figure
plots the average interest rate before and after the pandemic shocks hit the economy as we vary <span class="math notranslate nohighlight">\(\rho\)</span>. The figure shows that when <span class="math notranslate nohighlight">\(\rho&gt;\sigma\)</span> (more precisely <span class="math notranslate nohighlight">\(1/\rho&lt;1/\sigma\)</span>), interest rate drops when the pandemic shock hits, while it rises when <span class="math notranslate nohighlight">\(\rho&lt;\sigma\)</span> (<span class="math notranslate nohighlight">\(1/\rho&gt;1/\sigma\)</span>).
This is exactly the result discussed in <a class="reference external" href="http://economics.mit.edu/files/19351">Guerrieri et al. (2020)</a>.</p>
<a class="reference internal image-reference" href="../../_images/interest_rate_vary_rho.png"><img alt="../../_images/interest_rate_vary_rho.png" src="../../_images/interest_rate_vary_rho.png" style="width: 525.0px; height: 393.9px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../safe_assets/safe_assets.html" class="btn btn-neutral float-left" title="Barro et al. (2017): Safe Assets with Rare Disasters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../multi_country_rbc/multi_country_rbc.html" class="btn btn-neutral float-right" title="A Multi-country Business Cycle Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Dan Cao, Wenlan Luo, and Guangyu Nie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>