<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cao (2020): Continuum versus Finite Agents in Krusell and Smith (1998) &mdash; GDSGE Homepage</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contributed Examples" href="../ContributedExamples.html" />
    <link rel="prev" title="Cao (2018): Speculation and Wealth Distribution under Beliefs Heterogeneity" href="../Cao2018/Cao2018.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GDSGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures.html">Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbc.html">Getting Started - A Simple RBC Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple_zlb/simple_zlb.html">Comparison with OccBin: A Simple Model with an Occasionally Binding Interest Rate ZLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbcIrr.html">An RBC Model with Irreversible Investment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HL1996/HL1996.html">Heaton and Lucas (1996): Incomplete Markets with Portfolio Choices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Guvenen2009/Guvenen2009.html">Guvenen (2009): Asset Pricing with Heterogeneous IES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bianchi2011/Bianchi2011.html">Bianchi (2011): Sudden Stops in Open Economies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../safe_assets/safe_assets.html">Barro et al. (2017): Safe Assets with Rare Disasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandemic/GLSW2020.html">Guerrieri et al. (2022): Negative Supply Shocks That Cause Demand Shortages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_country_rbc/multi_country_rbc.html">A Multi-country Business Cycle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZLB/zlb.html">A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/functions.html">Toolbox API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../AdditionalExamples.html">Additional Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Huggett1997/Huggett1997.html">Huggett (1997): Steady States and Transition Paths in Heterogeneous Agent Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../KS1998/KS1998.html">Krusell and Smith (1998): Heterogeneous Agent Models with Aggregate Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Mendoza2010/Mendoza2010.html">Mendoza (2010): Sudden Stops with Asset Price Deflation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../KM1997/CaoNie2017.html">Cao and Nie (2017): Amplification and Asymmetry without Collateral Constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cao2018/Cao2018.html">Cao (2018): Speculation and Wealth Distribution under Beliefs Heterogeneity</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cao (2020): Continuum versus Finite Agents in Krusell and Smith (1998)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-model">The Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-gmod-file">The gmod file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ContributedExamples.html">Contributed Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDSGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../AdditionalExamples.html">Additional Examples</a></li>
      <li class="breadcrumb-item active">Cao (2020): Continuum versus Finite Agents in Krusell and Smith (1998)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cao-2020-continuum-versus-finite-agents-in-krusell-and-smith-1998">
<h1>Cao (2020): Continuum versus Finite Agents in Krusell and Smith (1998)<a class="headerlink" href="#cao-2020-continuum-versus-finite-agents-in-krusell-and-smith-1998" title="Permalink to this heading"></a></h1>
<p>Our toolbox is designed to solve models with only a finite number of agents, or more precisely, a finite number of agent types.
However, as noted in <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0022053119301255">Cao (2020)</a>, these models are important special cases of fully heterogenous agent models with a continuum of agents subject to both idiosyncratic and aggregate shocks such as the one <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998)</a>.
In particular, when idiosyncratic shocks are perfectly persistent in Krusell-Smith type of models, these models become effectively the finite-agent models that could be solved using our toolbox.
In this example, we solve and compare the aggregate outcomes in this special case of the model in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998)</a> to the outcomes in their original model where idiosyncratic shocks are not perfectly persistent.</p>
<section id="the-model">
<span id="cao2020"></span><h2>The Model<a class="headerlink" href="#the-model" title="Permalink to this heading"></a></h2>
<p>There are two representative agents <span class="math notranslate nohighlight">\(h\in\left\{ 1,2\right\}\)</span> in
the economy of mass <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> each. The agents share the same
inter-temporal expected utility</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}_{0}\left[\sum_{t=0}^{\infty}\beta^{t}\log c_{t}^{h}\right].\]</div>
<p>In each period, the exogenous aggregate state of the economy is a
pair of states <span class="math notranslate nohighlight">\(\left(s,i\right)\)</span> where <span class="math notranslate nohighlight">\(s\in\left\{ b,g\right\}\)</span>
and <span class="math notranslate nohighlight">\(i\in\left\{ 0,1\right\}\)</span>. State <span class="math notranslate nohighlight">\(s\)</span> determines the aggregate
productivity <span class="math notranslate nohighlight">\(A(s)\)</span> and aggregate labor supply <span class="math notranslate nohighlight">\(L(s)\)</span>. The aggregate
production function is Cobb-Douglas:</p>
<div class="math notranslate nohighlight">
\[F(s,K,L) = A(s)K^\alpha L^{1-\alpha},\]</div>
<p>where <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(L\)</span> are aggregate capital and labor.</p>
<p>State <span class="math notranslate nohighlight">\(i\)</span> determines which agent is employed. If <span class="math notranslate nohighlight">\(i=0\)</span> then agent
<span class="math notranslate nohighlight">\(1\)</span> is unemployed and agent <span class="math notranslate nohighlight">\(2\)</span> is employed, and vice versa for
<span class="math notranslate nohighlight">\(i=1\)</span>. This approximation of a fully idiosyncratic income process using a
two agent income process is similar to the approximation in <a class="reference external" href="https://www.journals.uchicago.edu/doi/10.1086/262030">Heaton and Lucas (1996)</a>. The employed agent has <span class="math notranslate nohighlight">\(2(1-\upsilon)L(s)\)</span> units of labor and the
unemployed agent has <span class="math notranslate nohighlight">\(2\upsilon L(s)\)</span> units of labor. <span class="math notranslate nohighlight">\(\upsilon\)</span>
stands for unemployment transfers by the government and is set at
<span class="math notranslate nohighlight">\(7\%\)</span>.</p>
<p>Markets are incomplete as agents can only invest in capital, subject to short-sale constraint.
So the sequential budget constraint of the agents is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;c^h_t + k^h_{t+1} \leq (1-\delta+r_t)k^h_t + w_t l^h_t,\\
&amp;0\leq k^h_{t+1},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_t\)</span> and <span class="math notranslate nohighlight">\(w_t\)</span> are market rental rate of capital and wage.</p>
<p>Because the agents’ problems are concave maximization problems, the first-order conditions are necessary and sufficient for optimality.
In particular, let <span class="math notranslate nohighlight">\(\lambda^h_t\)</span> denote the Lagrange multiplier on agent <span class="math notranslate nohighlight">\(h\)</span>’s short-sale constraint, then the Euler’s equation and complementary-slackness condition should hold in equilibrium:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\frac{1}{c^h_t} = \beta\mathbb{E}\left[(1-\delta+r_{t+1})\frac{1}{c^h_{t+1}}\right]+\lambda^h_t,\\
&amp;\lambda^h_t k^h_{t+1} = 0.\end{split}\]</div>
<p>In equilibrium, markets for capital and labor clear (and the good market clears by Walras’ law):</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;K_t = k^1_t + k^2_t,\\
&amp;L_t = l^1_t + l^2_t.\end{split}\]</div>
<p>To solve for recursive equilibrium in this economy, we use aggregate capital <span class="math notranslate nohighlight">\(K_t\)</span> and the wealth share of agent’s 1, <span class="math notranslate nohighlight">\(\omega_t = \frac{k^1_t}{K_t}\)</span>, as endogenous state variables.</p>
</section>
<section id="the-gmod-file">
<h2>The gmod file<a class="headerlink" href="#the-gmod-file" title="Permalink to this heading"></a></h2>
<p>The model is solved with <a class="reference download internal" download="" href="../../_downloads/8a9452ae86384620208da45ae4291542/Cao2020KS.gmod"><code class="xref download docutils literal notranslate"><span class="pre">Cao2020KS.gmod</span></code></a></p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c">% Parameters</span>
<span class="linenos">  2</span><span class="k">parameters</span> beta delta alpha sigma;
<span class="linenos">  3</span>beta=0.99; <span class="c">% discount factor</span>
<span class="linenos">  4</span>delta=0.025;
<span class="linenos">  5</span>alpha=0.36;
<span class="linenos">  6</span>sigma=1.0;
<span class="linenos">  7</span>PrintFreq = 10;
<span class="linenos">  8</span>SaveFreq = 50;
<span class="linenos">  9</span>SIMU_RESOLVE=0; SIMU_INTERP=1;
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="c">% States</span>
<span class="linenos"> 12</span><span class="k">var_state</span> K X;
<span class="linenos"> 13</span>XPts = 21;
<span class="linenos"> 14</span>XMin=0.0;
<span class="linenos"> 15</span>XMax=1.0;
<span class="linenos"> 16</span>X=linspace(XMin,XMax,XPts);
<span class="linenos"> 17</span>
<span class="linenos"> 18</span>KPts = 21;
<span class="linenos"> 19</span>KMin=5.0;
<span class="linenos"> 20</span>KMax=50.0;
<span class="linenos"> 21</span>K=exp(linspace(log(KMin), log(KMax), KPts));
<span class="linenos"> 22</span>
<span class="linenos"> 23</span><span class="c">% Shocks</span>
<span class="linenos"> 24</span><span class="k">shock_num</span> = 4;
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="k">var_shock</span> z e1 e2 L;
<span class="linenos"> 27</span><span class="c">% Set the length to be shock_num</span>
<span class="linenos"> 28</span>z=[0.99 1.01 0.99 1.01];
<span class="linenos"> 29</span>L=[0.2944 0.3140 0.2944 0.3140];
<span class="linenos"> 30</span>e1=[0.07*2*L(1) 0.07*2*L(2) 0.93*2*L(1) 0.93*2*L(2)];
<span class="linenos"> 31</span>e2=[0.93*2*L(1) 0.93*2*L(2) 0.07*2*L(1) 0.07*2*L(2)];
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="c">% Any intermediate steps can be done</span>
<span class="linenos"> 34</span>EZTrans =  [
<span class="linenos"> 35</span>    0.5250, 0.3500, 0.0312, 0.0938;
<span class="linenos"> 36</span>    0.0389, 0.8361, 0.0021, 0.1229;
<span class="linenos"> 37</span>    0.0938, 0.0312, 0.2917, 0.5833;
<span class="linenos"> 38</span>    0.0091, 0.1159, 0.0243, 0.8507
<span class="linenos"> 39</span>    ];
<span class="linenos"> 40</span><span class="c">% Convert to Pr((z,e)-&gt;(z&#39;,e&#39;))</span>
<span class="linenos"> 41</span>EZTrans = reshape(EZTrans,[2 2 2 2]);
<span class="linenos"> 42</span>ZETrans = permute(EZTrans,[2 1 4 3]);
<span class="linenos"> 43</span>ZETrans = reshape(ZETrans,[4 4]);
<span class="linenos"> 44</span><span class="k">shock_trans</span> = ZETrans;
<span class="linenos"> 45</span>
<span class="linenos"> 46</span><span class="c">% Tensor variables</span>
<span class="linenos"> 47</span><span class="k">var_tensor</span> r w budget1 budget2;
<span class="linenos"> 48</span><span class="c">% Notice use dot operator</span>
<span class="linenos"> 49</span>r = alpha*z.*(K./L).^(alpha-1);
<span class="linenos"> 50</span>w = (1-alpha)*z.*(K./L).^alpha;
<span class="linenos"> 51</span>budget1 = (1-delta+r).*(2*K).*(1-X) + w.*e1;
<span class="linenos"> 52</span>budget2 = (1-delta+r).*(2*K).*X + w.*e2;
<span class="linenos"> 53</span>
<span class="linenos"> 54</span><span class="c">% Endogenous variables, bounds, and initial values</span>
<span class="linenos"> 55</span><span class="k">var_policy</span> c1 c2 Kp Xp lambda1 lambda2;
<span class="linenos"> 56</span><span class="c">% Set bound of endogenous variable</span>
<span class="linenos"> 57</span><span class="c">% note var_tensor can be used (budget1 budget2)</span>
<span class="linenos"> 58</span><span class="c">% note scalar defined before can be used (KMax)</span>
<span class="linenos"> 59</span><span class="k">inbound</span> c1 0 budget1;
<span class="linenos"> 60</span><span class="k">inbound</span> c2 0 budget2;
<span class="linenos"> 61</span><span class="k">inbound</span> Kp 1e-12 10*KMax;
<span class="linenos"> 62</span><span class="k">inbound</span> Xp 0 1;
<span class="linenos"> 63</span><span class="k">inbound</span> lambda1 0 1;
<span class="linenos"> 64</span><span class="k">inbound</span> lambda2 0 1;
<span class="linenos"> 65</span>
<span class="linenos"> 66</span><span class="k">initial</span> c1 budget1;
<span class="linenos"> 67</span><span class="k">initial</span> c2 budget2;
<span class="linenos"> 68</span><span class="k">initial</span> Kp (KMin+KMax)/2;
<span class="linenos"> 69</span><span class="k">initial</span> Xp 0.5;
<span class="linenos"> 70</span>
<span class="linenos"> 71</span><span class="k">var_aux</span> kp1 kp2;
<span class="linenos"> 72</span>
<span class="linenos"> 73</span><span class="k">var_interp</span> c1Future c2Future;
<span class="linenos"> 74</span><span class="k">initial</span> c1Future budget1
<span class="linenos"> 75</span><span class="k">initial</span> c2Future budget2
<span class="linenos"> 76</span>c1Future = c1;
<span class="linenos"> 77</span>c2Future = c2;
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="k">var_output</span> Xp Kp kp1 kp2;
<span class="linenos"> 80</span>
<span class="linenos"> 81</span><span class="k">model;</span>
<span class="linenos"> 82</span>  <span class="c">% Budget constraints</span>
<span class="linenos"> 83</span>  kp1 = budget1 - c1;
<span class="linenos"> 84</span>  kp2 = budget2 - c2;
<span class="linenos"> 85</span>  
<span class="linenos"> 86</span>  <span class="c">% Flow marginal utility</span>
<span class="linenos"> 87</span>  upC1 = c1^-sigma;
<span class="linenos"> 88</span>  upC2 = c2^-sigma;
<span class="linenos"> 89</span>  
<span class="linenos"> 90</span>  <span class="c">% rhs of the Euler equation</span>
<span class="linenos"> 91</span>  rhs1 = lambda1;
<span class="linenos"> 92</span>  rhs2 = lambda2;
<span class="linenos"> 93</span>  
<span class="linenos"> 94</span>  <span class="c">% Variable with prime is future variable</span>
<span class="linenos"> 95</span>  r&#39; = alpha*z&#39;*(Kp/L&#39;)^(alpha-1);
<span class="linenos"> 96</span>  <span class="c">% Vector interpolation</span>
<span class="linenos"> 97</span>  [c1Next&#39;,c2Next&#39;] = <span class="k">GDSGE_INTERP_VEC&#39;</span>(Kp,Xp);
<span class="linenos"> 98</span>  <span class="c">% Note how to use the NDSGE_EXPECT operator</span>
<span class="linenos"> 99</span>  rhs1 = rhs1 + <span class="k">GDSGE_EXPECT</span>{ beta*(1-delta+r&#39;)*c1Next&#39;^(-sigma)/upC1} ;
<span class="linenos">100</span>  rhs2 = rhs2 + <span class="k">GDSGE_EXPECT</span>{ beta*(1-delta+r&#39;)*c2Next&#39;^(-sigma)/upC2} ;
<span class="linenos">101</span>  
<span class="linenos">102</span>  <span class="k">equations;</span>
<span class="linenos">103</span>    <span class="c">% Evolution of Kp</span>
<span class="linenos">104</span>    1 - (kp1+kp2)/(Kp*2);
<span class="linenos">105</span>    <span class="c">% Evolution of Xp</span>
<span class="linenos">106</span>    Xp - kp2/(Kp*2);
<span class="linenos">107</span>    1 - rhs1;
<span class="linenos">108</span>    1 - rhs2;
<span class="linenos">109</span>    kp1 / (2*Kp) * lambda1;
<span class="linenos">110</span>    kp2 / (2*Kp) * lambda2;
<span class="linenos">111</span>  <span class="k">end;</span>
<span class="linenos">112</span><span class="k">end;</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="k">simulate;</span>
<span class="linenos">115</span>  <span class="k">num_periods</span> = 10000;
<span class="linenos">116</span>  <span class="k">initial</span> K 10
<span class="linenos">117</span>  <span class="k">initial</span> X 0.5
<span class="linenos">118</span>  <span class="k">initial</span> shock 1
<span class="linenos">119</span>  <span class="k">var_simu</span> kp1 kp2;
<span class="linenos">120</span>  K&#39; = Kp;
<span class="linenos">121</span>  X&#39; = Xp;
<span class="linenos">122</span><span class="k">end;</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading"></a></h2>
<p>The parameters are taken from <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998, Section 2)</a>.
In particular, the discount rate and the production parameters are:</p>
<div class="math notranslate nohighlight">
\[\beta=0.99\ \ \ \delta=0.025\ \ \ \alpha=0.36.\]</div>
<p>The aggregate productivity and aggregate labor supply are:</p>
<div class="math notranslate nohighlight">
\[\begin{bmatrix}A(b) &amp; A(g)\end{bmatrix}=\begin{bmatrix}0.99 &amp; 1.01\end{bmatrix}\ \ \ \text{and}\ \ \ \begin{bmatrix}L(b) &amp; L(g)\end{bmatrix}=\begin{bmatrix}0.2944 &amp; 0.3140\end{bmatrix},\]</div>
<p>with the transition matrix <span class="math notranslate nohighlight">\(\pi=\left[\pi_{ss'ii'}\right]\)</span>, directly
taken from Section 2 in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998)</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\pi=\begin{bmatrix}0.5250 &amp; 0.3500 &amp; 0.0312 &amp; 0.0938\\0.0389 &amp; 0.8361 &amp; 0.0021 &amp; 0.1229\\0.0938 &amp; 0.0312 &amp; 0.2917 &amp; 0.5833\\0.0091 &amp; 0.1159 &amp; 0.0243 &amp; 0.8507\end{bmatrix}\end{split}\]</div>
<p>In this transition matrix, the rows and columns <span class="math notranslate nohighlight">\(\left\{ 1,2,3,4\right\}\)</span> correspond to states <span class="math notranslate nohighlight">\(\left\{ \left(b,0\right),\left(b,1\right),\left(g,0\right),\left(g,1\right)\right\}\)</span>.</p>
<p>The following figure shows next period aggregate capital,
<span class="math notranslate nohighlight">\(K_{t+1}\)</span> as a function of current period aggregate capital, <span class="math notranslate nohighlight">\(K_t\)</span>,
in current state <span class="math notranslate nohighlight">\(\left(b,0\right)\)</span>, for two different values of <span class="math notranslate nohighlight">\(\omega\)</span>: <span class="math notranslate nohighlight">\(\omega=0\)</span> and <span class="math notranslate nohighlight">\(\omega=1\)</span>. The figure shows that future aggregate
capital depends not only on current aggregate capital but also on
current wealth share <span class="math notranslate nohighlight">\(\omega\)</span> of agent <span class="math notranslate nohighlight">\(1\)</span>.</p>
<a class="reference internal image-reference" href="../../_images/KpPolicy.png"><img alt="../../_images/KpPolicy.png" src="../../_images/KpPolicy.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>Given the global solution for the recursive equilibrium of the model, we can
also simulate forward and carry out a regression exercise as in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998)</a>.
From <span class="math notranslate nohighlight">\(10,000\)</span>-period simulation (with the first <span class="math notranslate nohighlight">\(1000\)</span> periods dropped),
we obtain the following regression results:</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0438+0.9832\log K; &amp;  &amp; R^{2}=0.999223
\end{align*}\]</div>
<p>in good times and</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0167+0.9923\log K; &amp;  &amp; R^{2}=0.997372
\end{align*}\]</div>
<p>in bad times. These regression results tell us that, in the simulated
paths of the economy, current aggregate capital seems to be a sufficient
state variable to forecast future aggregate capital, which <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith</a>
call an <a href="#id4"><span class="problematic" id="id5">``</span></a>approximate aggregation’’ property. However, the figure tells us that this property does not hold globally.</p>
<p>As a comparison, we also solve the <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith</a>’s
model, with the exact parameters above, but in which idiosyncratic
shocks are truly idiosyncratic. We obtain the following regression
results:</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0906+0.9631\log K; &amp;  &amp; R^{2}=0.999999
\end{align*}\]</div>
<p>in good times</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0807+0.9651\log K; &amp;  &amp; R^{2}=0.999999
\end{align*}\]</div>
<p>and in bad times.</p>
<p>The approximate evolution of aggregate capital is not too different
in the two-agent economy compared to the <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith</a>’s
economy. But we observe that the auto-correlation coefficients for
log aggregate capital are lower than those in the two-agent economy.
The <span class="math notranslate nohighlight">\(R^{2}\)</span> are also slightly higher than in the two-agent economy.</p>
<p>We can also solve the finite-agent version of the model with stochastic discount factors in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith (1998, Section 3)</a>.
In their model, agents face idiosyncratic shocks
that determine their discount factor. The discount factor can be low
(<span class="math notranslate nohighlight">\(\underline{\beta}\)</span>) or high (<span class="math notranslate nohighlight">\(\bar{\beta}\)</span>), where:</p>
<div class="math notranslate nohighlight">
\[\underline{\beta}=0.9858\ \ \ \text{and}\ \ \ \bar{\beta}=0.9930.\]</div>
<p>The transition from one to the other is determined such that
the average duration for individual <span class="math notranslate nohighlight">\(\beta\)</span> is <span class="math notranslate nohighlight">\(50\)</span> years, which
corresponds to agents’ lifetime.</p>
<p>In the two-agent version of the model, we assume that each agent’s discount factor follows this stochastic process. But the two agents’ discount factors are perfectly negatively correlated.
To simplify the exercise, we assume that the two agents have the same labor productivity, which varies
with the aggregate state <span class="math notranslate nohighlight">\(s\)</span>. The evolution of the aggregate
state is the same as in the previous example. The other aggregate
state <span class="math notranslate nohighlight">\(i\)</span> determines the agents’ discount rate (<span class="math notranslate nohighlight">\(i=0\)</span> agent 1
has low discount factor and agent 2 has high discount factor and vice
versa for <span class="math notranslate nohighlight">\(i=1\)</span>). The evolution of aggregate state <span class="math notranslate nohighlight">\(i\)</span> is independent
of the evolution of aggregate state <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>The following figure shows next period aggregate
capital, <span class="math notranslate nohighlight">\(K_{t+1}\)</span> as a function of current period aggregate capital,
<span class="math notranslate nohighlight">\(K_t\)</span>, in state <span class="math notranslate nohighlight">\(\left(b,0\right)\)</span>, for two different values of <span class="math notranslate nohighlight">\(\omega\)</span>:
<span class="math notranslate nohighlight">\(\omega=0\)</span> and <span class="math notranslate nohighlight">\(\omega=1\)</span>. The figure shows that future aggregate
capital depends mostly on current aggregate capital and does not vary
visibly with the current wealth share <span class="math notranslate nohighlight">\(\omega\)</span> of agent 1.</p>
<a class="reference internal image-reference" href="../../_images/KpPolicyBetas.png"><img alt="../../_images/KpPolicyBetas.png" src="../../_images/KpPolicyBetas.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>As in the previous example, from <span class="math notranslate nohighlight">\(10,000\)</span>-period simulation (with
the first <span class="math notranslate nohighlight">\(1000\)</span> periods dropped), we obtain the following regression
results:</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0916+0.9633\log K; &amp;  &amp; R^{2}=0.999999
\end{align*}\]</div>
<p>in good times</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0789+0.9662\log K; &amp;  &amp; R^{2}=0.999999
\end{align*}\]</div>
<p>and in bad times. Because future aggregate capital depends mostly
on current aggregate capital, the fitness of the linear regressions
is very high.</p>
<p>As in the previous example, these regression results are comparable
to the ones in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/250034">Krusell and Smith</a>’s model in which the
discount rates are truly idiosyncratic:</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0871+0.9662\log K; &amp;  &amp; R^{2}=0.999981
\end{align*}\]</div>
<p>in good times and</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\log K'=0.0836+0.9670\log K; &amp;  &amp; R^{2}=0.999976
\end{align*}\]</div>
<p>in bad times.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Cao2018/Cao2018.html" class="btn btn-neutral float-left" title="Cao (2018): Speculation and Wealth Distribution under Beliefs Heterogeneity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ContributedExamples.html" class="btn btn-neutral float-right" title="Contributed Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Dan Cao, Wenlan Luo, and Guangyu Nie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>