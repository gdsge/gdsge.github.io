<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kiyotaki and Moore (1997): Credit Cycles &mdash; GDSGE Homepage</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Brumm et al (2015): A GDSGE model with asset price bubble" href="../Brumm2015/Brumm2015.html" />
    <link rel="prev" title="Heaton and Lucas (1996): Transition Function Iteration" href="../HL1996/HL1996TFIter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GDSGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures.html">Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbc.html">Getting Started - A Simple RBC Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple_zlb/simple_zlb.html">Comparison with OccBin: A Simple Model with an Occasionally Binding Interest Rate ZLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rbc/rbcIrr.html">An RBC Model with Irreversible Investment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HL1996/HL1996.html">Heaton and Lucas (1996): Incomplete Markets with Portfolio Choices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Guvenen2009/Guvenen2009.html">Guvenen (2009): Asset Pricing with Heterogeneous IES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bianchi2011/Bianchi2011.html">Bianchi (2011): Sudden Stops in Open Economies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../safe_assets/safe_assets.html">Barro et al. (2017): Safe Assets with Rare Disasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandemic/GLSW2020.html">Guerrieri et al. (2022): Negative Supply Shocks That Cause Demand Shortages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_country_rbc/multi_country_rbc.html">A Multi-country Business Cycle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZLB/zlb.html">A New-Keynesian Model with an Occasionally Binding Interest Rate Zero Lower Bound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/functions.html">Toolbox API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AdditionalExamples.html">Additional Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ContributedExamples.html">Contributed Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Coleman1991/Coleman1991.html">Coleman (1991): A production economy with an income tax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../HL1996/HL1996TFIter.html">Heaton and Lucas (1996): Transition Function Iteration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Kiyotaki and Moore (1997): Credit Cycles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-gmod-file">The gmod File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Brumm2015/Brumm2015.html">Brumm et al (2015): A GDSGE model with asset price bubble</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDSGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../ContributedExamples.html">Contributed Examples</a> &raquo;</li>
      <li>Kiyotaki and Moore (1997): Credit Cycles</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kiyotaki-and-moore-1997-credit-cycles">
<h1>Kiyotaki and Moore (1997): Credit Cycles<a class="headerlink" href="#kiyotaki-and-moore-1997-credit-cycles" title="Permalink to this heading"></a></h1>
<p>In <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/262072">their seminal 1997 paper</a>,
Kiyotaki and Moore put forth a model of credit cycles in which movements in asset prices interacts
with the real side of the economy and produce amplified and persistent effects of shocks to the economy.</p>
<p>Their original model is relatively simple with risk-neutral agents and one-time unanticipated MIT shocks.
<a class="reference external" href="https://www.linkedin.com/in/peter-paz-365311125/">Peter Frank Paz</a>, a Ph.D. candidate from New York University
proposes a more modern extension of the model with risk-averse agents and recurrent aggregate shocks.
The model fits squarely in GDSGE framework and Peter kindly contributed his gmod file below.</p>
<p>As in  <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/262072">Kiyotaki and Moore (1997)</a>
the economy consists of two production sectors, farming and gathering, with population
of each sector normalized to one. The farmers are more productive, but are less patient than the gatherers
and thus they tend to borrow from the gatherers in equilibrium.</p>
<p>A farmer solves</p>
<div class="math notranslate nohighlight">
\[\max_{\{x_t,k_t,b_t\}}\mathbb{E}_{0}\left[\sum_{t}\beta^{t}\frac{\left(x_{t}\right)^{1-\sigma}}{1-\sigma}\right],\]</div>
<p>subject to the budget constraint:</p>
<div class="math notranslate nohighlight" id="equation-eq-budget-farmer">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-budget-farmer" title="Permalink to this equation"></a></span>\[x_{t}+q_{t}k_{t}+\frac{b_{t}}{R_{t}}=y_{t}+q_{t}k_{t-1}+b_{t-1},\]</div>
<p>in which her resource is from production</p>
<div class="math notranslate nohighlight">
\[y_{t}=A_{t}\left(a+c\right)k_{t-1},\]</div>
<p>the value of land holding <span class="math notranslate nohighlight">\(q_{t}k_{t-1}\)</span>, and bond holding <span class="math notranslate nohighlight">\(b_{t-1}\)</span>.
The aggregate TFP shock <span class="math notranslate nohighlight">\(A_{t}\)</span> follows a Markov process. She allocates
her resource among consumption <span class="math notranslate nohighlight">\(x_{t}\)</span>, as well as land and bond
holding into the next period. As in <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/262072">Kiyotaki and Moore (1997)</a>, here
portion <span class="math notranslate nohighlight">\(c\)</span> of the output is non-tradable and has to be consumed,
i.e.,</p>
<div class="math notranslate nohighlight" id="equation-eq-nontradable-constraint-km">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-nontradable-constraint-km" title="Permalink to this equation"></a></span>\[x_{t}\geq A_{t}ck_{t-1},\]</div>
<p>and only the remaining portion <span class="math notranslate nohighlight">\(a\)</span> is tradable. She is also subject
to the following collateral constraint:</p>
<div class="math notranslate nohighlight" id="equation-eq-collateral-constraint-km">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-collateral-constraint-km" title="Permalink to this equation"></a></span>\[b_{t}+\theta\underline{q}_{t+1}k_{t}\geq0.\]</div>
<p>in which <span class="math notranslate nohighlight">\(\underline{q}_{t+1}\)</span> is the lowest possible land price
in the next period. In <a class="reference external" href="https://www.journals.uchicago.edu/doi/abs/10.1086/262072">Kiyotaki and Moore (1997)</a>
<span class="math notranslate nohighlight">\(\theta\)</span> is set at <span class="math notranslate nohighlight">\(1\)</span> but we allow <span class="math notranslate nohighlight">\(\theta\)</span> to be smaller than <span class="math notranslate nohighlight">\(1\)</span> in this extension
so that the collateral constraint binds with positive probability in the ergodic distribution of the model dynamics.</p>
<p>Similarly, a gatherer solves</p>
<div class="math notranslate nohighlight">
\[\max_{\{x_{t}^{\prime},k_{t}^{\prime},b_{t}^{\prime}\}}\mathbb{E}_{0}\left[\sum_{t}\left(\beta^{\prime}\right)^{t}\frac{\left(x_{t}^{\prime}\right)^{1-\sigma}}{1-\sigma}\right],\]</div>
<p>subject to the budget constraint,</p>
<div class="math notranslate nohighlight" id="equation-eq-budget-gatherer">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-budget-gatherer" title="Permalink to this equation"></a></span>\[x_{t}^{\prime}+q_{t}k_{t}^{\prime}+\frac{b_{t}^{\prime}}{R_{t}}=y_{t}^{\prime}+q_{t}k_{t-1}^{\prime}+b_{t-1}^{\prime},\]</div>
<p>in which her production function is concave,</p>
<div class="math notranslate nohighlight">
\[y_{t}^{\prime}=\underline{A}_{t}\left(k_{t-1}^{\prime}\right)^{\alpha}.\]</div>
<p>We assume the gatherers’ productivity <span class="math notranslate nohighlight">\(\underline{A}_{t}\)</span> is inferior,
and equals to a fixed proportion of <span class="math notranslate nohighlight">\(A_{t}\)</span>, i.e., <span class="math notranslate nohighlight">\(\underline{A}_{t}=\delta A_{t}\)</span>
with <span class="math notranslate nohighlight">\(\delta&lt;1\)</span>.</p>
<p>Let us denote the multipliers on the farmers’ budget constraint <a class="reference internal" href="#equation-eq-budget-farmer">(17)</a>
as <span class="math notranslate nohighlight">\(\beta^{t}\lambda_{t}\)</span>,  and on the tradability constraint <a class="reference internal" href="#equation-eq-nontradable-constraint-km">(18)</a>
as <span class="math notranslate nohighlight">\(\beta^{t}\eta_{t}\)</span>, and on the collateral constraint <a class="reference internal" href="#equation-eq-collateral-constraint-km">(19)</a> as
<span class="math notranslate nohighlight">\(\beta^{t}\mu_{t}\)</span>. Because the farmers and gatherers’ optimization problems are
globall concave maximization problems, the following first order conditions
and complementary-slackness conditions are neccessary and sufficient for optimality:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(x_{t}\right)^{-\sigma}-\lambda_{t}+\eta_{t} &amp; =0,\\
\eta_{t}\left(x_{t}-ck_{t-1}\right) &amp; =0,\\
-q_{t}\lambda_{t}+\theta\underline{q}_{t+1}\mu_{t}+\beta\mathbb{E}_{t}\left[ \left(q_{t+1}+a+c\right)\lambda_{t+1}-c\eta_{t+1}\right]&amp;=0,\\
-\frac{1}{R_{t}}\lambda_{t}+\mu_{t}+\beta\mathbb{E}_{t}\left[ \lambda_{t+1}\right]&amp;=0,\\
\mu_{t}\left(\theta\underline{q}_{t+1}k_{t}+b_{t}\right)&amp;=0,\\
\beta^{\prime}\mathbb{E}_{t}\left[ \left(\frac{q_{t+1}+\alpha\left(k_{t}^{\prime}\right)^{\alpha-1}}{q_{t}}\right)\left(\frac{x_{t+1}^{\prime}}{x_{t}^{\prime}}\right)^{-\sigma}\right]&amp;=1,\\
\beta^{\prime}R_{t}\mathbb{E}_{t}\left[ \left(\frac{x_{t+1}^{\prime}}{x_{t}^{\prime}}\right)^{-\sigma}\right]&amp;=1.\end{split}\]</div>
<p>The total land supply is fixed at <span class="math notranslate nohighlight">\(\overline{K}\)</span>, and the market
clearing conditions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}b_{t}+b_{t}^{\prime} &amp; =0,\\
k_{t}+k_{t}^{\prime} &amp; = \overline{K},\\
x_{t}+x_{t}^{\prime} &amp; = Y_t = A_{t}\left(a+c\right)k_{t-1}+\underline{A}_{t}\left(k_{t-1}^{\prime}\right)^{\alpha}.\end{split}\]</div>
<p>We define recursive equilibrium over two endogenous state variables.
The first-one is the farmers’ land-holding <span class="math notranslate nohighlight">\(k_{t-1}\)</span>.
The second one is the farmers’ financial wealth share defined as</p>
<div class="math notranslate nohighlight">
\[\omega_{t}=\frac{q_{t}k_{t-1}+b_{t-1}}{q_{t}\overline{K}}.\]</div>
<p>We use <span class="math notranslate nohighlight">\(\left(k_{t-1},\omega_{t}\right)\)</span>
as the endogenous state variables, instead of <span class="math notranslate nohighlight">\(\left(k_{t-1},b_{t-1}\right)\)</span>
in order to avoid multiple equilibria problems.
(The multiple equilibria problem in a similar setting is studied previously
in <a class="reference external" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3531341">Cao, Luo and Nie (2019)</a>.)</p>
<p>In the numerical exercise, we choose the shock process of TFP <span class="math notranslate nohighlight">\(A_{t}\)</span>
to be I.I.D., and <span class="math notranslate nohighlight">\(A_{t}\in\left\{ 0.99,1,1.01\right\}\)</span> with probability
<span class="math notranslate nohighlight">\(1/3\)</span> for each possible value. In
the ergodic distribution, the probabilities for binding collateral
constraint conditional on the three values of <span class="math notranslate nohighlight">\(A_{t}\)</span> are 92%, 80%
and 77% respectively. Thus the collateral constraint is more likely
to be binding when <span class="math notranslate nohighlight">\(A_{t}\)</span> is low.</p>
<p>The IRFs after positive and negative
1 percent TFP shocks (flipped for negative shocks) are plotted below by averaging the conditional
responses over the ergodic distribution (using the method
from the <span class="xref std std-ref">Guerrieri et al. (2020)</span> example
in the following <a class="reference download internal" download="" href="../../_downloads/c6ecd392d73a1975fde9b5f5e19c7e4e/main_simulate_KM1997_irf.m"><code class="xref download docutils literal notranslate"><span class="pre">MATLAB</span> <span class="pre">file</span></code></a>).</p>
<a class="reference internal image-reference" href="../../_images/KM1997_IRF.png"><img alt="../../_images/KM1997_IRF.png" src="../../_images/KM1997_IRF.png" style="width: 331.6px; height: 296.40000000000003px;" /></a>
<p>Although the TFP shocks are symmetric and temporary,
the IRFs show that their effects are asymmetric and persistent thanks to
market incompleteness and the collateral constraint <a class="reference internal" href="#equation-eq-collateral-constraint-km">(19)</a>.
In a more realistically calibrated model,
<a class="reference external" href="https://www.aeaweb.org/articles?id=10.1257/mac.20150219">Cao and Nie (2017)</a>  study
the importance of market incompleteness and collateral constraints in producing these effects.
They found that market incompleteness is relatively more important than collateral constraints.</p>
<section id="the-gmod-file">
<span id="km1997"></span><h2>The gmod File<a class="headerlink" href="#the-gmod-file" title="Permalink to this heading"></a></h2>
<p><a class="reference download internal" download="" href="../../_downloads/275fd230300861dbfdaed932a8039cf9/KM1997.gmod"><code class="xref download docutils literal notranslate"><span class="pre">KM1997.gmod</span></code></a></p>
<div class="highlight-GDSGE notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c">%========================================================================================</span>
<span class="linenos">  2</span><span class="c">%   PARAMETERS</span>
<span class="linenos">  3</span><span class="c">%========================================================================================</span>
<span class="linenos">  4</span><span class="k">parameters</span> a c alower sigma betaF betaG alpha Kbar theta;
<span class="linenos">  5</span>a = 0.7;        <span class="c">% tradable productivity of farmer</span>
<span class="linenos">  6</span>c = 0.3;      <span class="c">% nontradable productivity of farmer</span>
<span class="linenos">  7</span>alower=0.9;    <span class="c">% tradable productivity of gatherer</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="c">% preferences</span>
<span class="linenos"> 10</span>sigma=1;      <span class="c">% risk aversion coefficient</span>
<span class="linenos"> 11</span>betaF=0.95;   <span class="c">% discount factor of farmer</span>
<span class="linenos"> 12</span>betaG=0.98;   <span class="c">% discount factor of gatherer</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="c">% technology</span>
<span class="linenos"> 15</span>alpha=0.7;    <span class="c">% coefficient of gatherer&#39;s production</span>
<span class="linenos"> 16</span>Kbar=1;       <span class="c">% fixed capital stock</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="c">% credit</span>
<span class="linenos"> 19</span>theta=0.9;
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>SaveFreq = 200;
<span class="linenos"> 22</span>PrintFreq = 50;
<span class="linenos"> 23</span>INTERP_ORDER = 2;
<span class="linenos"> 24</span>EXTRAP_ORDER = 2;
<span class="linenos"> 25</span>SIMU_RESOLVE=0; 
<span class="linenos"> 26</span>SIMU_INTERP=1;  <span class="c">% Use interpolation for fast simulate</span>
<span class="linenos"> 27</span>IterSaveAll = 0;
<span class="linenos"> 28</span>
<span class="linenos"> 29</span><span class="c">%========================================================================================</span>
<span class="linenos"> 30</span><span class="c">%  ENDOGENOUS STATES</span>
<span class="linenos"> 31</span><span class="c">%========================================================================================</span>
<span class="linenos"> 32</span><span class="k">var_state</span> kF omega;
<span class="linenos"> 33</span>kFPts=41;
<span class="linenos"> 34</span>kFMin=0.02;
<span class="linenos"> 35</span>kFMax=0.95;
<span class="linenos"> 36</span>drift_K = 0.01;
<span class="linenos"> 37</span>kF=linspace(kFMin,kFMax,kFPts);
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>omegaPts=40;
<span class="linenos"> 40</span>omegaMin=0;
<span class="linenos"> 41</span>omegaMax=0.2;
<span class="linenos"> 42</span>omega=linspace(omegaMin,omegaMax,omegaPts);
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="c">%========================================================================================</span>
<span class="linenos"> 45</span><span class="c">%   SHOCKS</span>
<span class="linenos"> 46</span><span class="c">%========================================================================================</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="k">var_shock</span> A;
<span class="linenos"> 49</span>
<span class="linenos"> 50</span><span class="k">shock_num</span>=3;
<span class="linenos"> 51</span>A = [0.99 1 1.01];
<span class="linenos"> 52</span>shock_trans = ones(shock_num,shock_num)/<span class="k">shock_num</span>;
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>[KMesh,omegaMesh] = ndgrid(kF,omega);
<span class="linenos"> 55</span>
<span class="linenos"> 56</span>
<span class="linenos"> 57</span><span class="c">%========================================================================================</span>
<span class="linenos"> 58</span><span class="c">% STATE TRANSITION FUNCTION: INTERPOLATION Variables subset of Endogenous variables</span>
<span class="linenos"> 59</span><span class="c">%========================================================================================</span>
<span class="linenos"> 60</span><span class="k">var_policy</span>_init nxF xG eta kFpol R q nbFpol muF;
<span class="linenos"> 61</span><span class="k">inbound</span>_init nxF         0  10;
<span class="linenos"> 62</span><span class="k">inbound</span>_init xG          0  10;
<span class="linenos"> 63</span><span class="k">inbound</span>_init eta         0  1;
<span class="linenos"> 64</span><span class="k">inbound</span>_init kFpol       0  Kbar;
<span class="linenos"> 65</span><span class="k">inbound</span>_init R           0 10;
<span class="linenos"> 66</span><span class="k">inbound</span>_init q           0 10;
<span class="linenos"> 67</span><span class="k">inbound</span>_init nbFpol      0 10;      % Transformaion nbFpol = bFpol + theta*q*kFpol
<span class="linenos"> 68</span><span class="k">inbound</span>_init muF          0 1;
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="k">var_aux</span>_init loglambdaF loglambdaG logaux;
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="c">% This corresponds to the T-1 problem</span>
<span class="linenos"> 73</span><span class="k">model_init;</span>
<span class="linenos"> 74</span>    kG     =  Kbar-kF;                        <span class="c">% market clearing for capital state</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span>    <span class="c">% Backout bFpol</span>
<span class="linenos"> 77</span>    kGpol  =  Kbar-kFpol;                     <span class="c">% market clearing for capital policy</span>
<span class="linenos"> 78</span>    bFpol = nbFpol;
<span class="linenos"> 79</span>    bGpol = -bFpol;         <span class="c">% market clearing</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span>    <span class="c">% Backout xG and marginal utility</span>
<span class="linenos"> 82</span>    Y  =  A*(a+c)*kF + alower*A*kG^alpha;  <span class="c">% aggregate output</span>
<span class="linenos"> 83</span>    xF = nxF + c*A*kF;  <span class="c">% consumption of farmer</span>
<span class="linenos"> 84</span>
<span class="linenos"> 85</span>    lambdaF = xF^(-sigma)/(1-eta);   <span class="c">%multiplier for nontradable is eta*lambda</span>
<span class="linenos"> 86</span>    lambdaG = xG^(-sigma);
<span class="linenos"> 87</span>    loglambdaF = log(lambdaF);
<span class="linenos"> 88</span>    loglambdaG = log(lambdaG);    
<span class="linenos"> 89</span>    aux = (q+A*(a+c)-c*A*eta)*lambdaF;
<span class="linenos"> 90</span>    logaux = log(aux);
<span class="linenos"> 91</span>
<span class="linenos"> 92</span>    <span class="c">% In the last period, people consume everything, and qT=0</span>
<span class="linenos"> 93</span>    xF_next =  (a+c)*kFpol + bFpol;
<span class="linenos"> 94</span>    xG_next  = alower*kGpol^alpha + bGpol;
<span class="linenos"> 95</span>    lambdaF_next = xF_next^(-sigma);
<span class="linenos"> 96</span>    lambdaG_next = xG_next^(-sigma);
<span class="linenos"> 97</span>
<span class="linenos"> 98</span>    foc_bondG   = 1 - R*betaG*lambdaG_next / lambdaG;
<span class="linenos"> 99</span>    foc_kG      = q   - betaG*lambdaG_next*alower*alpha*kGpol^(alpha-1)/lambdaG;
<span class="linenos">100</span>
<span class="linenos">101</span>    foc_bondF   = 1  -  R*betaF*lambdaF_next / lambdaF   - muF;
<span class="linenos">102</span>    foc_kF      = q  -  betaF*(a+c)*lambdaF_next/lambdaF;
<span class="linenos">103</span>    slack_bF    = muF*nbFpol;
<span class="linenos">104</span>    slack_xF    = eta*nxF;
<span class="linenos">105</span>    budgetF     = q*kFpol +bFpol/R + xF - A*(a+c)*kF - omega*q*Kbar;
<span class="linenos">106</span>    MC_Y = Y - xF - xG;
<span class="linenos">107</span>
<span class="linenos">108</span>    <span class="k">equations;</span>
<span class="linenos">109</span>      foc_bondG;
<span class="linenos">110</span>      foc_kG; 
<span class="linenos">111</span>      foc_bondF;
<span class="linenos">112</span>      foc_kF;
<span class="linenos">113</span>      slack_bF;
<span class="linenos">114</span>      slack_xF;
<span class="linenos">115</span>      budgetF;
<span class="linenos">116</span>      MC_Y;
<span class="linenos">117</span>    <span class="k">end;</span>
<span class="linenos">118</span><span class="k">end;</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="k">var_interp</span> loglambdaF_interp loglambdaG_interp logaux_interp q_interp;
<span class="linenos">121</span><span class="c">%Time iteration update: update of the transition function after  a time iterarion step need to be specified.</span>
<span class="linenos">122</span>loglambdaF_interp = loglambdaF;
<span class="linenos">123</span>loglambdaG_interp = loglambdaG;
<span class="linenos">124</span>logaux_interp     = logaux;
<span class="linenos">125</span>q_interp       = q;
<span class="linenos">126</span>
<span class="linenos">127</span><span class="k">initial</span> loglambdaF_interp loglambdaF;
<span class="linenos">128</span><span class="k">initial</span> loglambdaG_interp loglambdaG;
<span class="linenos">129</span><span class="k">initial</span> logaux_interp logaux;
<span class="linenos">130</span><span class="k">initial</span> q_interp q;
<span class="linenos">131</span>
<span class="linenos">132</span><span class="c">%========================================================================================</span>
<span class="linenos">133</span><span class="c">%   Endogenous variables or policy  variables: name, and bounds</span>
<span class="linenos">134</span><span class="c">%========================================================================================</span>
<span class="linenos">135</span><span class="k">var_policy</span> nxF xG eta kFpol R q nbFpol muF omega_next[3];
<span class="linenos">136</span><span class="k">inbound</span> nxF         0  2;
<span class="linenos">137</span><span class="k">inbound</span> xG          0  2;
<span class="linenos">138</span><span class="k">inbound</span> eta         0  1;
<span class="linenos">139</span><span class="k">inbound</span> kFpol       0  Kbar;
<span class="linenos">140</span>inbound R           0  1.5 <span class="k">adaptive</span>(1.5);
<span class="linenos">141</span>inbound q           0 10 <span class="k">adaptive</span>(1.5);
<span class="linenos">142</span>inbound nbFpol      0 10 <span class="k">adaptive</span>(1.5);      % Transformaion nbFpol = bFpol + theta*q*kFpol
<span class="linenos">143</span><span class="k">inbound</span> muF         0 1;
<span class="linenos">144</span><span class="k">inbound</span> omega_next  0 1;
<span class="linenos">145</span>
<span class="linenos">146</span><span class="c">%====================================================</span>
<span class="linenos">147</span><span class="c">% Other equilibrium variables</span>
<span class="linenos">148</span><span class="c">%====================================================</span>
<span class="linenos">149</span><span class="k">var_aux</span> xF loglambdaF loglambdaG logaux bFpol Y bF; %qlow_next
<span class="linenos">150</span><span class="k">var_output</span> xF xG Y q R eta muF kFpol omega_next bF;
<span class="linenos">151</span>
<span class="linenos">152</span><span class="c">%====================================================</span>
<span class="linenos">153</span><span class="c">% MODEL</span>
<span class="linenos">154</span><span class="c">%====================================================</span>
<span class="linenos">155</span><span class="k">model;</span>
<span class="linenos">156</span>kG     =  Kbar-kF;                        <span class="c">% market clearing for capital state</span>
<span class="linenos">157</span>Y      =  A*(a+c)*kF + alower*A*kG^alpha;  <span class="c">% aggregate output</span>
<span class="linenos">158</span>
<span class="linenos">159</span>bF = q*omega*Kbar - q*kF;
<span class="linenos">160</span>
<span class="linenos">161</span>[loglambdaF_next&#39;, loglambdaG_next&#39;, logaux_next&#39;, q_next&#39;]=<span class="k">GDSGE_INTERP_VEC&#39;</span>(kFpol,omega_next&#39;);
<span class="linenos">162</span>lambdaF_next&#39; = exp(loglambdaF_next&#39;);
<span class="linenos">163</span>lambdaG_next&#39; = exp(loglambdaG_next&#39;);
<span class="linenos">164</span>aux_next&#39; = exp(logaux_next&#39;);
<span class="linenos">165</span>
<span class="linenos">166</span><span class="c">% Backout bFpol</span>
<span class="linenos">167</span>kGpol  =  Kbar-kFpol;                     <span class="c">% market clearing for capital policy</span>
<span class="linenos">168</span>quse = <span class="k">GDSGE_MIN</span>{q_next&#39;};
<span class="linenos">169</span>
<span class="linenos">170</span>bFpol = nbFpol - theta*quse*kFpol;
<span class="linenos">171</span>bGpol = -bFpol;         <span class="c">% market clearing</span>
<span class="linenos">172</span>  
<span class="linenos">173</span><span class="c">% Backout xG and marginal utility</span>
<span class="linenos">174</span>xF = nxF + c*A*kF;  <span class="c">% consumption of farmer</span>
<span class="linenos">175</span>lambdaF = xF^(-sigma)/(1-eta);
<span class="linenos">176</span>lambdaG = xG^(-sigma);
<span class="linenos">177</span>loglambdaF = log(lambdaF);
<span class="linenos">178</span>loglambdaG = log(lambdaG);
<span class="linenos">179</span>aux = (q+A*(a+c)-c*A*eta)*lambdaF;
<span class="linenos">180</span>logaux = log(aux);
<span class="linenos">181</span>
<span class="linenos">182</span>mpk_nextplusq&#39;= (alower*A&#39;)*alpha*kGpol^(alpha-1)+q_next&#39;;
<span class="linenos">183</span><span class="c">%Aplusqnext&#39;  = A&#39;*(a+c)+q_next&#39;;</span>
<span class="linenos">184</span>
<span class="linenos">185</span><span class="c">%====================================================</span>
<span class="linenos">186</span><span class="c">% calculate the residual equations: 8 equation (= 7+ 1 consistency) and 8 unknown</span>
<span class="linenos">187</span><span class="c">%====================================================</span>
<span class="linenos">188</span>foc_bondG   = 1 - R*(betaG*<span class="k">GDSGE_EXPECT</span>{lambdaG_next&#39;}) / lambdaG;
<span class="linenos">189</span>foc_kG      = q   - betaG*<span class="k">GDSGE_EXPECT</span>{lambdaG_next&#39;*mpk_nextplusq&#39;}/lambdaG;
<span class="linenos">190</span>
<span class="linenos">191</span>foc_bondF   = 1  -  R*(betaF*<span class="k">GDSGE_EXPECT</span>{lambdaF_next&#39;}) / lambdaF   - muF;
<span class="linenos">192</span>foc_kF      = q  -  betaF*<span class="k">GDSGE_EXPECT</span>{aux_next&#39;} /lambdaF   - theta*quse*muF/R;
<span class="linenos">193</span>slack_bF    = muF*nbFpol;
<span class="linenos">194</span>slack_xF    = eta*nxF;
<span class="linenos">195</span>budgetF     = q*kFpol +bFpol/R + xF - A*(a+c)*kF - omega*q*Kbar;
<span class="linenos">196</span>MC_Y = Y - xG - xF;
<span class="linenos">197</span>
<span class="linenos">198</span>consis_omega_next&#39; = (q_next&#39;*kFpol + bFpol) - q_next&#39;*omega_next&#39;*Kbar;
<span class="linenos">199</span>
<span class="linenos">200</span>   <span class="k">equations;</span>
<span class="linenos">201</span>     foc_bondG;
<span class="linenos">202</span>     foc_kG; 
<span class="linenos">203</span>     foc_bondF;
<span class="linenos">204</span>     foc_kF;
<span class="linenos">205</span>     slack_bF;
<span class="linenos">206</span>     slack_xF;
<span class="linenos">207</span>     budgetF;
<span class="linenos">208</span>     MC_Y;
<span class="linenos">209</span>     consis_omega_next&#39;;
<span class="linenos">210</span>    <span class="k">end;</span>
<span class="linenos">211</span><span class="k">end;</span>
<span class="linenos">212</span>
<span class="linenos">213</span><span class="k">simulate;</span>
<span class="linenos">214</span>   <span class="k">num_periods</span> = 1000;
<span class="linenos">215</span>   <span class="k">num_samples</span> = 100;
<span class="linenos">216</span>   <span class="k">initial</span> kF 0.05;%Kbar - (a/(alower*betaG*alpha))^(1/(alpha-1));
<span class="linenos">217</span>   <span class="k">initial</span> omega 0.01;
<span class="linenos">218</span>   <span class="k">initial</span> shock 2;
<span class="linenos">219</span>
<span class="linenos">220</span>   <span class="k">var_simu</span> xF xG Y q R eta muF bF; % some variables
<span class="linenos">221</span>   kF&#39;=kFpol;
<span class="linenos">222</span>   omega&#39; = omega_next&#39;;
<span class="linenos">223</span><span class="k">end;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../HL1996/HL1996TFIter.html" class="btn btn-neutral float-left" title="Heaton and Lucas (1996): Transition Function Iteration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Brumm2015/Brumm2015.html" class="btn btn-neutral float-right" title="Brumm et al (2015): A GDSGE model with asset price bubble" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Dan Cao, Wenlan Luo, and Guangyu Nie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>